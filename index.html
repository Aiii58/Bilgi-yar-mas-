<!DOCTYPE html>

<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Bilgi YarÄ±ÅŸmasÄ±</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0a12;
  --surface: #12121e;
  --surface2: #1a1a2e;
  --surface3: #22223a;
  --border: #2a2a44;
  --border-glow: #4a3aff;
  --primary: #6c5ce7;
  --primary-light: #a29bfe;
  --accent: #fd79a8;
  --accent2: #00cec9;
  --accent3: #fdcb6e;
  --text: #e8e8f0;
  --text-dim: #8888aa;
  --text-muted: #555577;
  --success: #00b894;
  --danger: #ff6b6b;
  --warning: #feca57;
  --radius: 14px;
  --radius-sm: 8px;
  --shadow: 0 8px 32px rgba(0,0,0,0.4);
  --glow: 0 0 20px rgba(108,92,231,0.3);
}

- { margin:0; padding:0; box-sizing:border-box; }

body {
font-family: â€˜Outfitâ€™, sans-serif;
background: var(â€“bg);
color: var(â€“text);
min-height: 100vh;
overflow-x: hidden;
}

body::before {
content: â€˜â€™;
position: fixed;
top: -50%; left: -50%;
width: 200%; height: 200%;
background: radial-gradient(ellipse at 30% 20%, rgba(108,92,231,0.08) 0%, transparent 50%),
radial-gradient(ellipse at 70% 80%, rgba(253,121,168,0.06) 0%, transparent 50%);
pointer-events: none;
z-index: 0;
}

/* â”€â”€â”€ Scrollbar â”€â”€â”€ */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(â€“bg); }
::-webkit-scrollbar-thumb { background: var(â€“border); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(â€“primary); }

/* â”€â”€â”€ Layout â”€â”€â”€ */
.app { position: relative; z-index: 1; max-width: 800px; margin: 0 auto; padding: 16px; min-height: 100vh; }

/* â”€â”€â”€ Header â”€â”€â”€ */
.header {
text-align: center;
padding: 28px 16px 20px;
margin-bottom: 8px;
}
.header h1 {
font-size: 2rem;
font-weight: 900;
letter-spacing: -1px;
background: linear-gradient(135deg, var(â€“primary-light), var(â€“accent), var(â€“accent3));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}
.header .subtitle {
color: var(â€“text-dim);
font-size: 0.85rem;
margin-top: 4px;
font-weight: 300;
}
.stats-bar {
display: flex;
justify-content: center;
gap: 24px;
margin-top: 14px;
}
.stat-item {
text-align: center;
}
.stat-num {
font-family: â€˜JetBrains Monoâ€™, monospace;
font-size: 1.4rem;
font-weight: 600;
color: var(â€“primary-light);
}
.stat-label {
font-size: 0.7rem;
color: var(â€“text-muted);
text-transform: uppercase;
letter-spacing: 1px;
}

/* â”€â”€â”€ Navigation â”€â”€â”€ */
.nav {
display: flex;
gap: 6px;
padding: 6px;
background: var(â€“surface);
border-radius: var(â€“radius);
border: 1px solid var(â€“border);
margin-bottom: 16px;
overflow-x: auto;
}
.nav-btn {
flex: 1;
padding: 10px 8px;
border: none;
background: transparent;
color: var(â€“text-dim);
font-family: â€˜Outfitâ€™, sans-serif;
font-size: 0.78rem;
font-weight: 600;
border-radius: var(â€“radius-sm);
cursor: pointer;
transition: all 0.25s;
white-space: nowrap;
display: flex;
align-items: center;
justify-content: center;
gap: 5px;
}
.nav-btn:hover { color: var(â€“text); background: var(â€“surface2); }
.nav-btn.active {
background: var(â€“primary);
color: #fff;
box-shadow: 0 4px 15px rgba(108,92,231,0.4);
}
.nav-btn .icon { font-size: 1rem; }

/* â”€â”€â”€ Sections â”€â”€â”€ */
.section { display: none; animation: fadeIn 0.3s ease; }
.section.active { display: block; }
@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

/* â”€â”€â”€ Cards â”€â”€â”€ */
.card {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius);
padding: 20px;
margin-bottom: 12px;
transition: all 0.2s;
}
.card:hover { border-color: var(â€“border-glow); box-shadow: var(â€“glow); }
.card-title {
font-size: 0.95rem;
font-weight: 700;
margin-bottom: 14px;
display: flex;
align-items: center;
gap: 8px;
}
.card-title .badge {
font-size: 0.65rem;
padding: 3px 8px;
border-radius: 20px;
font-weight: 600;
text-transform: uppercase;
letter-spacing: 0.5px;
}
.badge-mc { background: rgba(108,92,231,0.2); color: var(â€“primary-light); }
.badge-classic { background: rgba(0,206,201,0.2); color: var(â€“accent2); }
.badge-audio { background: rgba(253,121,168,0.2); color: var(â€“accent); }

/* â”€â”€â”€ Form Elements â”€â”€â”€ */
.form-group { margin-bottom: 14px; }
.form-label {
display: block;
font-size: 0.78rem;
font-weight: 600;
color: var(â€“text-dim);
margin-bottom: 6px;
text-transform: uppercase;
letter-spacing: 0.5px;
}
.form-input, .form-select, .form-textarea {
width: 100%;
padding: 12px 14px;
background: var(â€“surface2);
border: 1px solid var(â€“border);
border-radius: var(â€“radius-sm);
color: var(â€“text);
font-family: â€˜Outfitâ€™, sans-serif;
font-size: 0.9rem;
transition: all 0.2s;
outline: none;
}
.form-input:focus, .form-select:focus, .form-textarea:focus {
border-color: var(â€“primary);
box-shadow: 0 0 0 3px rgba(108,92,231,0.15);
}
.form-textarea { resize: vertical; min-height: 80px; }
.form-select { cursor: pointer; appearance: none;
background-image: url(â€œdata:image/svg+xml,%3Csvg xmlns=â€˜http://www.w3.org/2000/svgâ€™ width=â€˜12â€™ height=â€˜12â€™ viewBox=â€˜0 0 24 24â€™ fill=â€˜noneâ€™ stroke=â€™%238888aaâ€™ stroke-width=â€˜2â€™%3E%3Cpath d=â€˜M6 9l6 6 6-6â€™/%3E%3C/svg%3Eâ€);
background-repeat: no-repeat;
background-position: right 14px center;
padding-right: 36px;
}
.form-select option { background: var(â€“surface2); color: var(â€“text); }

/* â”€â”€â”€ Buttons â”€â”€â”€ */
.btn {
display: inline-flex;
align-items: center;
justify-content: center;
gap: 6px;
padding: 11px 20px;
border: none;
border-radius: var(â€“radius-sm);
font-family: â€˜Outfitâ€™, sans-serif;
font-size: 0.85rem;
font-weight: 600;
cursor: pointer;
transition: all 0.2s;
}
.btn-primary {
background: linear-gradient(135deg, var(â€“primary), #8b7cf7);
color: #fff;
box-shadow: 0 4px 15px rgba(108,92,231,0.35);
}
.btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(108,92,231,0.5); }
.btn-success { background: var(â€“success); color: #fff; }
.btn-success:hover { background: #00d2a0; }
.btn-danger { background: var(â€“danger); color: #fff; }
.btn-danger:hover { background: #ff5252; }
.btn-outline {
background: transparent;
border: 1px solid var(â€“border);
color: var(â€“text-dim);
}
.btn-outline:hover { border-color: var(â€“primary); color: var(â€“text); }
.btn-sm { padding: 7px 14px; font-size: 0.78rem; }
.btn-block { width: 100%; }
.btn-group { display: flex; gap: 8px; flex-wrap: wrap; }

/* â”€â”€â”€ Options for MC â”€â”€â”€ */
.options-container { display: flex; flex-direction: column; gap: 8px; }
.option-row {
display: flex;
gap: 8px;
align-items: center;
}
.option-letter {
width: 32px; height: 32px;
display: flex; align-items: center; justify-content: center;
background: var(â€“surface3);
border-radius: 50%;
font-size: 0.75rem;
font-weight: 700;
color: var(â€“text-dim);
flex-shrink: 0;
}
.option-row .form-input { flex: 1; }
.correct-radio {
width: 20px; height: 20px;
appearance: none;
border: 2px solid var(â€“border);
border-radius: 50%;
cursor: pointer;
transition: all 0.2s;
flex-shrink: 0;
}
.correct-radio:checked {
border-color: var(â€“success);
background: var(â€“success);
box-shadow: inset 0 0 0 3px var(â€“surface2);
}

/* â”€â”€â”€ Audio â”€â”€â”€ */
.audio-zone {
background: var(â€“surface2);
border: 2px dashed var(â€“border);
border-radius: var(â€“radius);
padding: 24px;
text-align: center;
margin-bottom: 14px;
transition: all 0.3s;
}
.audio-zone.has-audio { border-color: var(â€“accent); border-style: solid; }
.audio-zone .icon-big { font-size: 2.5rem; margin-bottom: 8px; }
.audio-zone p { font-size: 0.8rem; color: var(â€“text-dim); }
.record-btn {
width: 56px; height: 56px;
border-radius: 50%;
border: 3px solid var(â€“accent);
background: transparent;
color: var(â€“accent);
font-size: 1.3rem;
cursor: pointer;
transition: all 0.3s;
margin: 10px 8px;
}
.record-btn:hover { background: rgba(253,121,168,0.15); }
.record-btn.recording {
background: var(â€“danger);
border-color: var(â€“danger);
color: #fff;
animation: pulse 1s infinite;
}
@keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.08); } }

.audio-player-mini {
width: 100%;
margin-top: 10px;
height: 36px;
border-radius: 20px;
}
.upload-audio-btn {
display: inline-flex;
align-items: center;
gap: 5px;
padding: 8px 16px;
background: var(â€“surface3);
border: 1px solid var(â€“border);
border-radius: 20px;
color: var(â€“text-dim);
font-family: â€˜Outfitâ€™, sans-serif;
font-size: 0.8rem;
cursor: pointer;
transition: all 0.2s;
margin: 6px 4px;
}
.upload-audio-btn:hover { border-color: var(â€“primary); color: var(â€“text); }

/* â”€â”€â”€ Question List â”€â”€â”€ */
.q-list-item {
display: flex;
align-items: center;
gap: 12px;
padding: 14px 16px;
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius-sm);
margin-bottom: 8px;
cursor: pointer;
transition: all 0.2s;
}
.q-list-item:hover { border-color: var(â€“primary); transform: translateX(4px); }
.q-type-icon {
width: 38px; height: 38px;
border-radius: 10px;
display: flex;
align-items: center;
justify-content: center;
font-size: 1.1rem;
flex-shrink: 0;
}
.q-type-mc { background: rgba(108,92,231,0.15); }
.q-type-classic { background: rgba(0,206,201,0.15); }
.q-type-audio { background: rgba(253,121,168,0.15); }
.q-info { flex: 1; min-width: 0; }
.q-info .q-text {
font-size: 0.88rem;
font-weight: 500;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}
.q-info .q-meta {
font-size: 0.72rem;
color: var(â€“text-muted);
margin-top: 2px;
}
.q-actions {
display: flex;
gap: 4px;
}
.q-action-btn {
width: 32px; height: 32px;
border: none;
background: var(â€“surface2);
color: var(â€“text-dim);
border-radius: 8px;
cursor: pointer;
font-size: 0.85rem;
transition: all 0.2s;
}
.q-action-btn:hover { background: var(â€“surface3); color: var(â€“text); }
.q-action-btn.delete:hover { background: rgba(255,107,107,0.2); color: var(â€“danger); }

/* â”€â”€â”€ Quiz Play â”€â”€â”€ */
.quiz-progress {
display: flex;
align-items: center;
gap: 12px;
margin-bottom: 16px;
}
.progress-bar {
flex: 1;
height: 6px;
background: var(â€“surface3);
border-radius: 3px;
overflow: hidden;
}
.progress-fill {
height: 100%;
background: linear-gradient(90deg, var(â€“primary), var(â€“accent));
border-radius: 3px;
transition: width 0.4s ease;
}
.progress-text {
font-family: â€˜JetBrains Monoâ€™, monospace;
font-size: 0.8rem;
color: var(â€“text-dim);
white-space: nowrap;
}

.quiz-question-card {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius);
padding: 28px 24px;
margin-bottom: 16px;
text-align: center;
}
.quiz-question-card .q-number {
font-size: 0.72rem;
color: var(â€“text-muted);
text-transform: uppercase;
letter-spacing: 1px;
margin-bottom: 12px;
}
.quiz-question-card .q-text {
font-size: 1.15rem;
font-weight: 600;
line-height: 1.5;
}

.quiz-option {
display: flex;
align-items: center;
gap: 12px;
padding: 14px 18px;
background: var(â€“surface);
border: 2px solid var(â€“border);
border-radius: var(â€“radius-sm);
margin-bottom: 8px;
cursor: pointer;
transition: all 0.25s;
font-size: 0.92rem;
}
.quiz-option:hover { border-color: var(â€“primary); background: var(â€“surface2); }
.quiz-option.selected { border-color: var(â€“primary); background: rgba(108,92,231,0.1); }
.quiz-option.correct { border-color: var(â€“success); background: rgba(0,184,148,0.1); }
.quiz-option.wrong { border-color: var(â€“danger); background: rgba(255,107,107,0.1); }
.quiz-option .opt-letter {
width: 30px; height: 30px;
display: flex; align-items: center; justify-content: center;
border-radius: 50%;
background: var(â€“surface3);
font-weight: 700;
font-size: 0.8rem;
flex-shrink: 0;
}

.quiz-answer-input {
width: 100%;
padding: 16px;
background: var(â€“surface);
border: 2px solid var(â€“border);
border-radius: var(â€“radius-sm);
color: var(â€“text);
font-family: â€˜Outfitâ€™, sans-serif;
font-size: 1.1rem;
text-align: center;
outline: none;
margin-bottom: 12px;
transition: all 0.2s;
}
.quiz-answer-input:focus { border-color: var(â€“primary); }

/* â”€â”€â”€ Results â”€â”€â”€ */
.result-card {
text-align: center;
padding: 40px 24px;
}
.result-score {
font-family: â€˜JetBrains Monoâ€™, monospace;
font-size: 4rem;
font-weight: 800;
background: linear-gradient(135deg, var(â€“success), var(â€“accent2));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}
.result-label {
font-size: 1rem;
color: var(â€“text-dim);
margin-top: 4px;
}
.result-breakdown {
display: flex;
justify-content: center;
gap: 32px;
margin: 24px 0;
}
.result-item .num {
font-family: â€˜JetBrains Monoâ€™, monospace;
font-size: 1.5rem;
font-weight: 700;
}
.result-item .lbl {
font-size: 0.72rem;
color: var(â€“text-muted);
text-transform: uppercase;
letter-spacing: 0.5px;
}
.result-item.correct .num { color: var(â€“success); }
.result-item.wrong .num { color: var(â€“danger); }

/* â”€â”€â”€ Import/Export â”€â”€â”€ */
.io-card {
display: flex;
align-items: center;
gap: 16px;
padding: 20px;
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius);
margin-bottom: 10px;
cursor: pointer;
transition: all 0.2s;
}
.io-card:hover { border-color: var(â€“primary); }
.io-icon {
width: 48px; height: 48px;
border-radius: 12px;
display: flex; align-items: center; justify-content: center;
font-size: 1.4rem;
}
.io-icon.export { background: rgba(0,184,148,0.15); }
.io-icon.import { background: rgba(108,92,231,0.15); }
.io-info h3 { font-size: 0.95rem; font-weight: 600; }
.io-info p { font-size: 0.78rem; color: var(â€“text-dim); margin-top: 2px; }

/* â”€â”€â”€ Filter/Search â”€â”€â”€ */
.filter-bar {
display: flex;
gap: 8px;
margin-bottom: 14px;
flex-wrap: wrap;
}
.filter-bar .form-input { flex: 1; min-width: 150px; padding: 9px 14px; font-size: 0.82rem; }
.filter-bar .form-select { width: auto; min-width: 120px; padding: 9px 36px 9px 14px; font-size: 0.82rem; }

/* â”€â”€â”€ Category Tags â”€â”€â”€ */
.cat-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 14px; }
.cat-tag {
padding: 5px 12px;
background: var(â€“surface2);
border: 1px solid var(â€“border);
border-radius: 20px;
font-size: 0.75rem;
color: var(â€“text-dim);
cursor: pointer;
transition: all 0.2s;
}
.cat-tag:hover, .cat-tag.active { border-color: var(â€“primary); color: var(â€“primary-light); background: rgba(108,92,231,0.1); }

/* â”€â”€â”€ Empty State â”€â”€â”€ */
.empty-state {
text-align: center;
padding: 48px 20px;
color: var(â€“text-muted);
}
.empty-state .icon { font-size: 3rem; margin-bottom: 12px; opacity: 0.5; }
.empty-state p { font-size: 0.9rem; }

/* â”€â”€â”€ Toast â”€â”€â”€ */
.toast {
position: fixed;
bottom: 24px;
left: 50%;
transform: translateX(-50%) translateY(100px);
background: var(â€“surface2);
border: 1px solid var(â€“border);
border-radius: var(â€“radius);
padding: 12px 24px;
font-size: 0.85rem;
z-index: 9999;
transition: transform 0.3s ease;
box-shadow: var(â€“shadow);
}
.toast.show { transform: translateX(-50%) translateY(0); }
.toast.success { border-color: var(â€“success); }
.toast.error { border-color: var(â€“danger); }

/* â”€â”€â”€ Modal â”€â”€â”€ */
.modal-overlay {
position: fixed;
inset: 0;
background: rgba(0,0,0,0.7);
z-index: 1000;
display: none;
align-items: center;
justify-content: center;
padding: 16px;
backdrop-filter: blur(4px);
}
.modal-overlay.show { display: flex; }
.modal {
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius);
padding: 24px;
max-width: 500px;
width: 100%;
max-height: 80vh;
overflow-y: auto;
animation: fadeIn 0.25s ease;
}
.modal h3 { margin-bottom: 16px; font-size: 1.1rem; }

/* â”€â”€â”€ Responsive â”€â”€â”€ */
@media (max-width: 600px) {
.app { padding: 10px; }
.header h1 { font-size: 1.5rem; }
.stats-bar { gap: 16px; }
.stat-num { font-size: 1.1rem; }
.nav-btn { padding: 8px 6px; font-size: 0.72rem; }
.nav-btn .icon { font-size: 0.85rem; }
.card { padding: 16px; }
.quiz-question-card { padding: 20px 16px; }
.quiz-question-card .q-text { font-size: 1rem; }
.result-score { font-size: 3rem; }
}

.hidden-input { display: none; }

/* Quiz Config */
.quiz-config {
display: flex;
flex-direction: column;
gap: 12px;
}
.config-option {
display: flex;
align-items: center;
justify-content: space-between;
padding: 14px 16px;
background: var(â€“surface);
border: 1px solid var(â€“border);
border-radius: var(â€“radius-sm);
}
.config-option label {
font-size: 0.88rem;
font-weight: 500;
}
.toggle {
position: relative;
width: 44px;
height: 24px;
background: var(â€“surface3);
border-radius: 12px;
cursor: pointer;
transition: background 0.3s;
}
.toggle.on { background: var(â€“primary); }
.toggle::after {
content: â€˜â€™;
position: absolute;
top: 3px;
left: 3px;
width: 18px;
height: 18px;
background: #fff;
border-radius: 50%;
transition: transform 0.3s;
}
.toggle.on::after { transform: translateX(20px); }
</style>

</head>
<body>

<div class="app">
  <!-- Header -->
  <div class="header">
    <h1>ğŸ§  Bilgi YarÄ±ÅŸmasÄ±</h1>
    <div class="subtitle">Soru BankasÄ± & Quiz Sistemi</div>
    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-num" id="statTotal">0</div>
        <div class="stat-label">Toplam Soru</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="statMC">0</div>
        <div class="stat-label">ÅÄ±klÄ±</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="statClassic">0</div>
        <div class="stat-label">Klasik</div>
      </div>
      <div class="stat-item">
        <div class="stat-num" id="statAudio">0</div>
        <div class="stat-label">Sesli</div>
      </div>
    </div>
  </div>

  <!-- Navigation -->

  <div class="nav">
    <button class="nav-btn active" data-tab="questions"><span class="icon">ğŸ“‹</span> Sorular</button>
    <button class="nav-btn" data-tab="add"><span class="icon">â•</span> Ekle</button>
    <button class="nav-btn" data-tab="quiz"><span class="icon">ğŸ®</span> YarÄ±ÅŸma</button>
    <button class="nav-btn" data-tab="io"><span class="icon">ğŸ’¾</span> Aktar</button>
  </div>

  <!-- SECTION: Questions List -->

  <div class="section active" id="sec-questions">
    <div class="filter-bar">
      <input type="text" class="form-input" id="searchInput" placeholder="ğŸ” Soru ara...">
      <select class="form-select" id="filterType">
        <option value="all">TÃ¼mÃ¼</option>
        <option value="mc">ÅÄ±klÄ±</option>
        <option value="classic">Klasik</option>
        <option value="audio">Sesli</option>
      </select>
      <select class="form-select" id="filterCategory">
        <option value="all">TÃ¼m Kategoriler</option>
      </select>
    </div>
    <div id="questionsList"></div>
  </div>

  <!-- SECTION: Add Question -->

  <div class="section" id="sec-add">
    <div class="card">
      <div class="card-title">Yeni Soru Ekle</div>

```
  <div class="form-group">
    <label class="form-label">Soru Tipi</label>
    <select class="form-select" id="addType" onchange="onTypeChange()">
      <option value="mc">ğŸ“ ÅÄ±klÄ± Soru (Ã‡oktan SeÃ§meli)</option>
      <option value="classic">âœï¸ Klasik Soru (YazÄ±lÄ± Cevap)</option>
      <option value="audio">ğŸµ Sesli Soru</option>
    </select>
  </div>

  <div class="form-group">
    <label class="form-label">Kategori</label>
    <div style="display:flex;gap:8px">
      <input type="text" class="form-input" id="addCategory" placeholder="Ã–rn: Tarih, CoÄŸrafya, Genel KÃ¼ltÃ¼r..." list="categoryList">
      <datalist id="categoryList"></datalist>
    </div>
  </div>

  <div class="form-group" id="questionTextGroup">
    <label class="form-label">Soru Metni</label>
    <textarea class="form-textarea" id="addQuestion" placeholder="Sorunuzu buraya yazÄ±n..."></textarea>
  </div>

  <!-- MC Options -->
  <div id="mcOptions">
    <label class="form-label">ÅÄ±klar <span style="font-weight:400;color:var(--text-muted)">(doÄŸru olanÄ± iÅŸaretleyin)</span></label>
    <div class="options-container" id="optionsContainer">
      <div class="option-row">
        <div class="option-letter">A</div>
        <input type="text" class="form-input" placeholder="A ÅŸÄ±kkÄ±">
        <input type="radio" name="correctOpt" value="0" class="correct-radio" checked>
      </div>
      <div class="option-row">
        <div class="option-letter">B</div>
        <input type="text" class="form-input" placeholder="B ÅŸÄ±kkÄ±">
        <input type="radio" name="correctOpt" value="1" class="correct-radio">
      </div>
      <div class="option-row">
        <div class="option-letter">C</div>
        <input type="text" class="form-input" placeholder="C ÅŸÄ±kkÄ±">
        <input type="radio" name="correctOpt" value="2" class="correct-radio">
      </div>
      <div class="option-row">
        <div class="option-letter">D</div>
        <input type="text" class="form-input" placeholder="D ÅŸÄ±kkÄ±">
        <input type="radio" name="correctOpt" value="3" class="correct-radio">
      </div>
    </div>
  </div>

  <!-- Classic Answer -->
  <div id="classicAnswer" style="display:none">
    <div class="form-group">
      <label class="form-label">DoÄŸru Cevap</label>
      <input type="text" class="form-input" id="addAnswer" placeholder="CevabÄ± yazÄ±n...">
    </div>
    <div class="form-group">
      <label class="form-label">Ä°pucu (Opsiyonel)</label>
      <input type="text" class="form-input" id="addHint" placeholder="Ä°pucu veya ek bilgi...">
    </div>
  </div>

  <!-- Audio -->
  <div id="audioSection" style="display:none">
    <div class="audio-zone" id="audioZone">
      <div class="icon-big">ğŸ¤</div>
      <p>Ses kaydÄ± yapÄ±n veya dosya yÃ¼kleyin</p>
      <div style="margin-top:12px">
        <button class="record-btn" id="recordBtn" onclick="toggleRecording()" title="KayÄ±t BaÅŸlat">âº</button>
        <button class="upload-audio-btn" onclick="document.getElementById('audioFileInput').click()">
          ğŸ“ Dosya YÃ¼kle
        </button>
        <input type="file" id="audioFileInput" class="hidden-input" accept="audio/*" onchange="handleAudioUpload(event)">
      </div>
      <audio id="audioPreview" class="audio-player-mini" controls style="display:none"></audio>
    </div>
    <div class="form-group">
      <label class="form-label">DoÄŸru Cevap</label>
      <input type="text" class="form-input" id="addAudioAnswer" placeholder="Sesli sorunun cevabÄ±...">
    </div>
  </div>

  <div style="margin-top:18px">
    <button class="btn btn-primary btn-block" onclick="saveQuestion()" id="saveBtn">
      ğŸ’¾ Soruyu Kaydet
    </button>
  </div>
</div>
```

  </div>

  <!-- SECTION: Quiz Play -->

  <div class="section" id="sec-quiz">
    <!-- Quiz Setup -->
    <div id="quizSetup">
      <div class="card">
        <div class="card-title">ğŸ® YarÄ±ÅŸma AyarlarÄ±</div>
        <div class="quiz-config">
          <div class="form-group">
            <label class="form-label">Soru SayÄ±sÄ±</label>
            <input type="number" class="form-input" id="quizCount" value="10" min="1" max="999">
          </div>
          <div class="form-group">
            <label class="form-label">Soru Tipi</label>
            <select class="form-select" id="quizType">
              <option value="all">TÃ¼m Tipler</option>
              <option value="mc">Sadece ÅÄ±klÄ±</option>
              <option value="classic">Sadece Klasik</option>
              <option value="audio">Sadece Sesli</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Kategori</label>
            <select class="form-select" id="quizCategory">
              <option value="all">TÃ¼m Kategoriler</option>
            </select>
          </div>
          <div class="config-option">
            <label>SorularÄ± KarÄ±ÅŸtÄ±r</label>
            <div class="toggle on" id="toggleShuffle" onclick="this.classList.toggle('on')"></div>
          </div>
        </div>
        <div style="margin-top:18px">
          <button class="btn btn-primary btn-block" onclick="startQuiz()">ğŸš€ YarÄ±ÅŸmayÄ± BaÅŸlat</button>
        </div>
      </div>
    </div>

```
<!-- Quiz Playing -->
<div id="quizPlaying" style="display:none">
  <div class="quiz-progress">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">1/10</div>
  </div>
  <div id="quizContent"></div>
  <div id="quizActions" style="margin-top:14px;text-align:center"></div>
</div>

<!-- Quiz Results -->
<div id="quizResults" style="display:none"></div>
```

  </div>

  <!-- SECTION: Import/Export -->

  <div class="section" id="sec-io">
    <div class="io-card" onclick="exportData()">
      <div class="io-icon export">ğŸ“¤</div>
      <div class="io-info">
        <h3>DÄ±ÅŸa Aktar</h3>
        <p>TÃ¼m sorularÄ± JSON dosyasÄ± olarak indir</p>
      </div>
    </div>
    <div class="io-card" onclick="document.getElementById('importFileInput').click()">
      <div class="io-icon import">ğŸ“¥</div>
      <div class="io-info">
        <h3>Ä°Ã§e Aktar</h3>
        <p>JSON dosyasÄ±ndan sorularÄ± yÃ¼kle</p>
      </div>
    </div>
    <input type="file" id="importFileInput" class="hidden-input" accept=".json" onchange="importData(event)">

```
<div class="card" style="margin-top:16px">
  <div class="card-title">âš ï¸ Tehlikeli BÃ¶lge</div>
  <p style="font-size:0.82rem;color:var(--text-dim);margin-bottom:14px">TÃ¼m sorularÄ± silmek geri alÄ±namaz bir iÅŸlemdir.</p>
  <button class="btn btn-danger btn-sm" onclick="clearAllData()">ğŸ—‘ï¸ TÃ¼m SorularÄ± Sil</button>
</div>

<div class="card" style="margin-top:12px">
  <div class="card-title">â„¹ï¸ Depolama Bilgisi</div>
  <p style="font-size:0.82rem;color:var(--text-dim)" id="storageInfo">YÃ¼kleniyor...</p>
</div>
```

  </div>
</div>

<!-- Toast -->

<div class="toast" id="toast"></div>

<!-- Modal -->

<div class="modal-overlay" id="modalOverlay">
  <div class="modal" id="modalContent"></div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IndexedDB Setup
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DB_NAME = 'BilgiYarismasi';
const DB_VERSION = 1;
const STORE_NAME = 'questions';
let db = null;

function openDB() {
  return new Promise((resolve, reject) => {
    const req = indexedDB.open(DB_NAME, DB_VERSION);
    req.onupgradeneeded = (e) => {
      const d = e.target.result;
      if (!d.objectStoreNames.contains(STORE_NAME)) {
        const store = d.createObjectStore(STORE_NAME, { keyPath: 'id' });
        store.createIndex('type', 'type', { unique: false });
        store.createIndex('category', 'category', { unique: false });
        store.createIndex('createdAt', 'createdAt', { unique: false });
      }
    };
    req.onsuccess = (e) => { db = e.target.result; resolve(db); };
    req.onerror = (e) => reject(e.target.error);
  });
}

function dbTransaction(mode = 'readonly') {
  const tx = db.transaction(STORE_NAME, mode);
  return tx.objectStore(STORE_NAME);
}

function dbGetAll() {
  return new Promise((resolve, reject) => {
    const req = dbTransaction().getAll();
    req.onsuccess = () => resolve(req.result);
    req.onerror = () => reject(req.error);
  });
}

function dbPut(item) {
  return new Promise((resolve, reject) => {
    const req = dbTransaction('readwrite').put(item);
    req.onsuccess = () => resolve(req.result);
    req.onerror = () => reject(req.error);
  });
}

function dbDelete(id) {
  return new Promise((resolve, reject) => {
    const req = dbTransaction('readwrite').delete(id);
    req.onsuccess = () => resolve();
    req.onerror = () => reject(req.error);
  });
}

function dbClear() {
  return new Promise((resolve, reject) => {
    const req = dbTransaction('readwrite').clear();
    req.onsuccess = () => resolve();
    req.onerror = () => reject(req.error);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// State
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let allQuestions = [];
let editingId = null;
let currentAudioData = null;
let mediaRecorder = null;
let audioChunks = [];
let isRecording = false;

// Quiz state
let quizQuestions = [];
let quizIndex = 0;
let quizScore = 0;
let quizAnswered = false;
let quizAnswers = [];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Navigation
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.nav-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('sec-' + btn.dataset.tab).classList.add('active');
    if (btn.dataset.tab === 'questions') renderQuestionsList();
    if (btn.dataset.tab === 'quiz') resetQuizUI();
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Toast
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, type = 'success') {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast ' + type + ' show';
  setTimeout(() => t.classList.remove('show'), 2500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Type Change
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function onTypeChange() {
  const type = document.getElementById('addType').value;
  document.getElementById('mcOptions').style.display = type === 'mc' ? 'block' : 'none';
  document.getElementById('classicAnswer').style.display = type === 'classic' ? 'block' : 'none';
  document.getElementById('audioSection').style.display = type === 'audio' ? 'block' : 'none';
  document.getElementById('questionTextGroup').style.display = type === 'audio' ? 'block' : 'block';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Audio Recording
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function toggleRecording() {
  const btn = document.getElementById('recordBtn');
  if (!isRecording) {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];
      mediaRecorder.ondataavailable = (e) => audioChunks.push(e.data);
      mediaRecorder.onstop = async () => {
        const blob = new Blob(audioChunks, { type: 'audio/webm' });
        stream.getTracks().forEach(t => t.stop());
        const reader = new FileReader();
        reader.onload = () => {
          currentAudioData = reader.result;
          showAudioPreview(currentAudioData);
        };
        reader.readAsDataURL(blob);
      };
      mediaRecorder.start();
      isRecording = true;
      btn.classList.add('recording');
      btn.textContent = 'â¹';
      btn.title = 'KaydÄ± Durdur';
    } catch(e) {
      showToast('Mikrofon eriÅŸimi reddedildi!', 'error');
    }
  } else {
    mediaRecorder.stop();
    isRecording = false;
    btn.classList.remove('recording');
    btn.textContent = 'âº';
    btn.title = 'KayÄ±t BaÅŸlat';
  }
}

function handleAudioUpload(e) {
  const file = e.target.files[0];
  if (!file) return;
  if (file.size > 10 * 1024 * 1024) {
    showToast('Dosya Ã§ok bÃ¼yÃ¼k! (Maks 10MB)', 'error');
    return;
  }
  const reader = new FileReader();
  reader.onload = () => {
    currentAudioData = reader.result;
    showAudioPreview(currentAudioData);
  };
  reader.readAsDataURL(file);
  e.target.value = '';
}

function showAudioPreview(dataUrl) {
  const zone = document.getElementById('audioZone');
  const preview = document.getElementById('audioPreview');
  preview.src = dataUrl;
  preview.style.display = 'block';
  zone.classList.add('has-audio');
  showToast('Ses kaydedildi âœ“');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Save Question
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function saveQuestion() {
  const type = document.getElementById('addType').value;
  const category = document.getElementById('addCategory').value.trim() || 'Genel';
  const questionText = document.getElementById('addQuestion').value.trim();

  if (!questionText) {
    showToast('Soru metni boÅŸ olamaz!', 'error');
    return;
  }

  let question = {
    id: editingId || Date.now().toString() + Math.random().toString(36).substr(2, 5),
    type,
    category,
    question: questionText,
    createdAt: editingId ? undefined : new Date().toISOString(),
    updatedAt: new Date().toISOString()
  };

  if (editingId) {
    const existing = allQuestions.find(q => q.id === editingId);
    if (existing) question.createdAt = existing.createdAt;
  }

  if (type === 'mc') {
    const inputs = document.querySelectorAll('#optionsContainer .form-input');
    const options = Array.from(inputs).map(i => i.value.trim());
    if (options.some(o => !o)) {
      showToast('TÃ¼m ÅŸÄ±klarÄ± doldurun!', 'error');
      return;
    }
    const correctIdx = parseInt(document.querySelector('input[name="correctOpt"]:checked').value);
    question.options = options;
    question.correctIndex = correctIdx;
  } else if (type === 'classic') {
    const answer = document.getElementById('addAnswer').value.trim();
    if (!answer) {
      showToast('DoÄŸru cevabÄ± girin!', 'error');
      return;
    }
    question.answer = answer;
    question.hint = document.getElementById('addHint').value.trim();
  } else if (type === 'audio') {
    const answer = document.getElementById('addAudioAnswer').value.trim();
    if (!answer) {
      showToast('Sesli soru cevabÄ±nÄ± girin!', 'error');
      return;
    }
    if (!currentAudioData && !editingId) {
      showToast('Ses kaydÄ± ekleyin!', 'error');
      return;
    }
    question.answer = answer;
    if (currentAudioData) question.audioData = currentAudioData;
    else if (editingId) {
      const existing = allQuestions.find(q => q.id === editingId);
      if (existing && existing.audioData) question.audioData = existing.audioData;
    }
  }

  await dbPut(question);
  allQuestions = await dbGetAll();

  showToast(editingId ? 'Soru gÃ¼ncellendi âœ“' : 'Soru kaydedildi âœ“');
  resetAddForm();
  updateStats();
  updateCategories();
}

function resetAddForm() {
  editingId = null;
  currentAudioData = null;
  document.getElementById('addType').value = 'mc';
  document.getElementById('addCategory').value = '';
  document.getElementById('addQuestion').value = '';
  document.getElementById('addAnswer').value = '';
  document.getElementById('addHint').value = '';
  document.getElementById('addAudioAnswer').value = '';
  document.querySelectorAll('#optionsContainer .form-input').forEach(i => i.value = '');
  document.querySelector('input[name="correctOpt"][value="0"]').checked = true;
  document.getElementById('audioPreview').style.display = 'none';
  document.getElementById('audioPreview').src = '';
  document.getElementById('audioZone').classList.remove('has-audio');
  document.getElementById('saveBtn').textContent = 'ğŸ’¾ Soruyu Kaydet';
  onTypeChange();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Edit Question
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function editQuestion(id) {
  const q = allQuestions.find(x => x.id === id);
  if (!q) return;

  editingId = id;

  // Switch to add tab
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelector('[data-tab="add"]').classList.add('active');
  document.getElementById('sec-add').classList.add('active');

  document.getElementById('addType').value = q.type;
  document.getElementById('addCategory').value = q.category || '';
  document.getElementById('addQuestion').value = q.question;

  onTypeChange();

  if (q.type === 'mc') {
    const inputs = document.querySelectorAll('#optionsContainer .form-input');
    q.options.forEach((opt, i) => { if (inputs[i]) inputs[i].value = opt; });
    const radio = document.querySelector(`input[name="correctOpt"][value="${q.correctIndex}"]`);
    if (radio) radio.checked = true;
  } else if (q.type === 'classic') {
    document.getElementById('addAnswer').value = q.answer || '';
    document.getElementById('addHint').value = q.hint || '';
  } else if (q.type === 'audio') {
    document.getElementById('addAudioAnswer').value = q.answer || '';
    if (q.audioData) {
      currentAudioData = q.audioData;
      showAudioPreview(q.audioData);
    }
  }

  document.getElementById('saveBtn').textContent = 'âœï¸ Soruyu GÃ¼ncelle';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Delete Question
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function deleteQuestion(id) {
  const q = allQuestions.find(x => x.id === id);
  if (!q) return;

  const modal = document.getElementById('modalContent');
  modal.innerHTML = `
    <h3>âš ï¸ Soruyu Sil</h3>
    <p style="color:var(--text-dim);font-size:0.88rem;margin-bottom:6px">"${q.question.substring(0, 80)}${q.question.length > 80 ? '...' : ''}"</p>
    <p style="color:var(--text-dim);font-size:0.82rem;margin-bottom:18px">Bu iÅŸlem geri alÄ±namaz.</p>
    <div class="btn-group">
      <button class="btn btn-danger" onclick="confirmDelete('${id}')">Sil</button>
      <button class="btn btn-outline" onclick="closeModal()">Ä°ptal</button>
    </div>
  `;
  document.getElementById('modalOverlay').classList.add('show');
}

async function confirmDelete(id) {
  await dbDelete(id);
  allQuestions = await dbGetAll();
  closeModal();
  renderQuestionsList();
  updateStats();
  updateCategories();
  showToast('Soru silindi');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('show');
}

document.getElementById('modalOverlay').addEventListener('click', (e) => {
  if (e.target === e.currentTarget) closeModal();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Render Questions List
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderQuestionsList() {
  const search = document.getElementById('searchInput').value.toLowerCase();
  const typeFilter = document.getElementById('filterType').value;
  const catFilter = document.getElementById('filterCategory').value;

  let filtered = allQuestions.filter(q => {
    if (typeFilter !== 'all' && q.type !== typeFilter) return false;
    if (catFilter !== 'all' && q.category !== catFilter) return false;
    if (search && !q.question.toLowerCase().includes(search)) return false;
    return true;
  });

  // Sort by newest first
  filtered.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

  const container = document.getElementById('questionsList');

  if (filtered.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="icon">ğŸ“­</div>
        <p>${allQuestions.length === 0 ? 'HenÃ¼z soru eklenmemiÅŸ.<br>BaÅŸlamak iÃ§in "Ekle" sekmesine gidin!' : 'AramanÄ±zla eÅŸleÅŸen soru bulunamadÄ±.'}</p>
      </div>`;
    return;
  }

  const typeIcons = { mc: 'ğŸ“', classic: 'âœï¸', audio: 'ğŸµ' };
  const typeClasses = { mc: 'q-type-mc', classic: 'q-type-classic', audio: 'q-type-audio' };
  const typeLabels = { mc: 'ÅÄ±klÄ±', classic: 'Klasik', audio: 'Sesli' };

  container.innerHTML = filtered.map(q => `
    <div class="q-list-item" onclick="previewQuestion('${q.id}')">
      <div class="q-type-icon ${typeClasses[q.type]}">${typeIcons[q.type]}</div>
      <div class="q-info">
        <div class="q-text">${escHTML(q.question)}</div>
        <div class="q-meta">${typeLabels[q.type]} Â· ${escHTML(q.category || 'Genel')} Â· ${formatDate(q.createdAt)}</div>
      </div>
      <div class="q-actions" onclick="event.stopPropagation()">
        <button class="q-action-btn" onclick="editQuestion('${q.id}')" title="DÃ¼zenle">âœï¸</button>
        <button class="q-action-btn delete" onclick="deleteQuestion('${q.id}')" title="Sil">ğŸ—‘ï¸</button>
      </div>
    </div>
  `).join('');
}

function previewQuestion(id) {
  const q = allQuestions.find(x => x.id === id);
  if (!q) return;

  const modal = document.getElementById('modalContent');
  let content = `<h3 style="margin-bottom:6px">${escHTML(q.question)}</h3>`;
  content += `<p style="font-size:0.78rem;color:var(--text-muted);margin-bottom:16px">${q.type === 'mc' ? 'ÅÄ±klÄ±' : q.type === 'classic' ? 'Klasik' : 'Sesli'} Â· ${escHTML(q.category || 'Genel')}</p>`;

  if (q.type === 'mc') {
    const letters = ['A', 'B', 'C', 'D', 'E'];
    content += q.options.map((o, i) =>
      `<div style="padding:8px 12px;margin-bottom:4px;border-radius:8px;font-size:0.88rem;${i === q.correctIndex ? 'background:rgba(0,184,148,0.15);color:var(--success);font-weight:600' : 'color:var(--text-dim)'}">
        ${letters[i]}) ${escHTML(o)} ${i === q.correctIndex ? 'âœ“' : ''}
      </div>`
    ).join('');
  } else if (q.type === 'classic') {
    content += `<div style="padding:10px 14px;background:rgba(0,184,148,0.1);border-radius:8px;margin-bottom:8px">
      <span style="font-size:0.75rem;color:var(--text-muted)">CEVAP:</span><br>
      <span style="color:var(--success);font-weight:600">${escHTML(q.answer)}</span>
    </div>`;
    if (q.hint) content += `<p style="font-size:0.82rem;color:var(--text-dim)">ğŸ’¡ Ä°pucu: ${escHTML(q.hint)}</p>`;
  } else if (q.type === 'audio') {
    if (q.audioData) content += `<audio controls src="${q.audioData}" style="width:100%;margin:10px 0"></audio>`;
    content += `<div style="padding:10px 14px;background:rgba(0,184,148,0.1);border-radius:8px">
      <span style="font-size:0.75rem;color:var(--text-muted)">CEVAP:</span><br>
      <span style="color:var(--success);font-weight:600">${escHTML(q.answer)}</span>
    </div>`;
  }

  content += `<div class="btn-group" style="margin-top:18px">
    <button class="btn btn-outline btn-sm" onclick="closeModal()">Kapat</button>
    <button class="btn btn-primary btn-sm" onclick="closeModal();editQuestion('${q.id}')">âœï¸ DÃ¼zenle</button>
  </div>`;

  modal.innerHTML = content;
  document.getElementById('modalOverlay').classList.add('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Quiz Logic
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function resetQuizUI() {
  document.getElementById('quizSetup').style.display = 'block';
  document.getElementById('quizPlaying').style.display = 'none';
  document.getElementById('quizResults').style.display = 'none';
  updateCategories();
}

function startQuiz() {
  const count = parseInt(document.getElementById('quizCount').value) || 10;
  const typeFilter = document.getElementById('quizType').value;
  const catFilter = document.getElementById('quizCategory').value;
  const shuffle = document.getElementById('toggleShuffle').classList.contains('on');

  let pool = allQuestions.filter(q => {
    if (typeFilter !== 'all' && q.type !== typeFilter) return false;
    if (catFilter !== 'all' && q.category !== catFilter) return false;
    return true;
  });

  if (pool.length === 0) {
    showToast('Bu filtreyle eÅŸleÅŸen soru yok!', 'error');
    return;
  }

  if (shuffle) pool = pool.sort(() => Math.random() - 0.5);
  quizQuestions = pool.slice(0, count);
  quizIndex = 0;
  quizScore = 0;
  quizAnswered = false;
  quizAnswers = [];

  document.getElementById('quizSetup').style.display = 'none';
  document.getElementById('quizPlaying').style.display = 'block';
  document.getElementById('quizResults').style.display = 'none';

  renderQuizQuestion();
}

function renderQuizQuestion() {
  const q = quizQuestions[quizIndex];
  const total = quizQuestions.length;
  quizAnswered = false;

  // Progress
  document.getElementById('progressFill').style.width = ((quizIndex / total) * 100) + '%';
  document.getElementById('progressText').textContent = `${quizIndex + 1}/${total}`;

  const content = document.getElementById('quizContent');
  const actions = document.getElementById('quizActions');

  let html = `<div class="quiz-question-card">
    <div class="q-number">Soru ${quizIndex + 1} / ${total} Â· ${q.type === 'mc' ? 'ÅÄ±klÄ±' : q.type === 'classic' ? 'Klasik' : 'Sesli'}</div>`;

  if (q.type === 'audio' && q.audioData) {
    html += `<audio controls src="${q.audioData}" style="width:100%;margin:10px 0;max-width:400px"></audio><br>`;
  }

  html += `<div class="q-text">${escHTML(q.question)}</div></div>`;

  if (q.type === 'mc') {
    const letters = ['A', 'B', 'C', 'D', 'E'];
    html += q.options.map((opt, i) =>
      `<div class="quiz-option" data-idx="${i}" onclick="selectMCOption(${i})">
        <div class="opt-letter">${letters[i]}</div>
        <span>${escHTML(opt)}</span>
      </div>`
    ).join('');
    actions.innerHTML = `<button class="btn btn-primary" onclick="checkMCAnswer()" id="checkBtn" disabled>CevabÄ± Kontrol Et</button>`;
  } else {
    if (q.hint) html += `<p style="font-size:0.82rem;color:var(--text-dim);margin-bottom:8px;text-align:center">ğŸ’¡ ${escHTML(q.hint)}</p>`;
    html += `<input type="text" class="quiz-answer-input" id="quizAnswerInput" placeholder="CevabÄ±nÄ±zÄ± yazÄ±n..." onkeydown="if(event.key==='Enter')checkClassicAnswer()">`;
    actions.innerHTML = `<button class="btn btn-primary" onclick="checkClassicAnswer()">CevabÄ± Kontrol Et</button>`;
  }

  content.innerHTML = html;
}

let selectedMCOption = -1;

function selectMCOption(idx) {
  if (quizAnswered) return;
  selectedMCOption = idx;
  document.querySelectorAll('.quiz-option').forEach((el, i) => {
    el.classList.toggle('selected', i === idx);
  });
  document.getElementById('checkBtn').disabled = false;
}

function checkMCAnswer() {
  if (quizAnswered) return;
  quizAnswered = true;
  const q = quizQuestions[quizIndex];
  const correct = q.correctIndex === selectedMCOption;

  document.querySelectorAll('.quiz-option').forEach((el, i) => {
    if (i === q.correctIndex) el.classList.add('correct');
    if (i === selectedMCOption && !correct) el.classList.add('wrong');
    el.style.pointerEvents = 'none';
  });

  if (correct) quizScore++;
  quizAnswers.push({ question: q, userAnswer: selectedMCOption, correct });
  selectedMCOption = -1;
  showNextButton();
}

function checkClassicAnswer() {
  if (quizAnswered) return;
  quizAnswered = true;
  const q = quizQuestions[quizIndex];
  const input = document.getElementById('quizAnswerInput');
  const userAnswer = input.value.trim();
  const correct = userAnswer.toLowerCase() === q.answer.toLowerCase();

  input.disabled = true;
  input.style.borderColor = correct ? 'var(--success)' : 'var(--danger)';

  if (!correct) {
    const content = document.getElementById('quizContent');
    content.innerHTML += `<div style="text-align:center;padding:10px;color:var(--success);font-size:0.92rem;margin-top:4px">
      DoÄŸru cevap: <strong>${escHTML(q.answer)}</strong>
    </div>`;
  }

  if (correct) quizScore++;
  quizAnswers.push({ question: q, userAnswer, correct });
  showNextButton();
}

function showNextButton() {
  const actions = document.getElementById('quizActions');
  if (quizIndex < quizQuestions.length - 1) {
    actions.innerHTML = `<button class="btn btn-primary" onclick="nextQuizQuestion()">Sonraki Soru â†’</button>`;
  } else {
    actions.innerHTML = `<button class="btn btn-success" onclick="showQuizResults()">SonuÃ§larÄ± GÃ¶r ğŸ†</button>`;
  }
}

function nextQuizQuestion() {
  quizIndex++;
  renderQuizQuestion();
}

function showQuizResults() {
  document.getElementById('quizPlaying').style.display = 'none';
  const results = document.getElementById('quizResults');
  results.style.display = 'block';

  const total = quizQuestions.length;
  const wrong = total - quizScore;
  const pct = Math.round((quizScore / total) * 100);

  let emoji = 'ğŸ‰';
  if (pct < 50) emoji = 'ğŸ’ª';
  else if (pct < 75) emoji = 'ğŸ‘';
  else if (pct < 100) emoji = 'ğŸŒŸ';
  else emoji = 'ğŸ†';

  let html = `<div class="card result-card">
    <div style="font-size:3rem;margin-bottom:8px">${emoji}</div>
    <div class="result-score">%${pct}</div>
    <div class="result-label">BaÅŸarÄ± OranÄ±</div>
    <div class="result-breakdown">
      <div class="result-item correct">
        <div class="num">${quizScore}</div>
        <div class="lbl">DoÄŸru</div>
      </div>
      <div class="result-item wrong">
        <div class="num">${wrong}</div>
        <div class="lbl">YanlÄ±ÅŸ</div>
      </div>
      <div class="result-item">
        <div class="num" style="color:var(--text)">${total}</div>
        <div class="lbl">Toplam</div>
      </div>
    </div>
    <div class="btn-group" style="justify-content:center">
      <button class="btn btn-primary" onclick="startQuiz()">ğŸ”„ Tekrar Oyna</button>
      <button class="btn btn-outline" onclick="resetQuizUI()">âš™ï¸ Ayarlar</button>
    </div>
  </div>`;

  // Answer review
  html += `<div class="card" style="margin-top:12px"><div class="card-title">ğŸ“Š Cevap DetaylarÄ±</div>`;
  quizAnswers.forEach((a, i) => {
    const q = a.question;
    const icon = a.correct ? 'âœ…' : 'âŒ';
    let detail = '';
    if (q.type === 'mc') {
      const letters = ['A', 'B', 'C', 'D', 'E'];
      detail = a.correct ? `${letters[a.userAnswer]}` : `SeÃ§im: ${letters[a.userAnswer]} â†’ DoÄŸru: ${letters[q.correctIndex]}`;
    } else {
      detail = a.correct ? a.userAnswer : `"${a.userAnswer}" â†’ "${q.answer}"`;
    }
    html += `<div style="padding:10px 0;border-bottom:1px solid var(--border);font-size:0.85rem">
      ${icon} <strong>${i + 1}.</strong> ${escHTML(q.question.substring(0, 60))}${q.question.length > 60 ? '...' : ''}
      <div style="color:var(--text-dim);font-size:0.78rem;margin-top:2px">${escHTML(detail)}</div>
    </div>`;
  });
  html += '</div>';

  results.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Import / Export
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function exportData() {
  const questions = await dbGetAll();
  if (questions.length === 0) {
    showToast('DÄ±ÅŸa aktarÄ±lacak soru yok!', 'error');
    return;
  }

  const data = {
    app: 'BilgiYarismasi',
    version: 1,
    exportDate: new Date().toISOString(),
    count: questions.length,
    questions
  };

  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `bilgi-yarismasi-${new Date().toISOString().slice(0, 10)}.json`;
  a.click();
  URL.revokeObjectURL(url);
  showToast(`${questions.length} soru dÄ±ÅŸa aktarÄ±ldÄ± âœ“`);
}

async function importData(e) {
  const file = e.target.files[0];
  if (!file) return;

  try {
    const text = await file.text();
    const data = JSON.parse(text);

    let questions = [];
    if (data.questions && Array.isArray(data.questions)) {
      questions = data.questions;
    } else if (Array.isArray(data)) {
      questions = data;
    } else {
      throw new Error('GeÃ§ersiz format');
    }

    // Validate
    questions = questions.filter(q => q.type && q.question);

    if (questions.length === 0) {
      showToast('GeÃ§erli soru bulunamadÄ±!', 'error');
      return;
    }

    const modal = document.getElementById('modalContent');
    modal.innerHTML = `
      <h3>ğŸ“¥ Ä°Ã§e Aktar</h3>
      <p style="color:var(--text-dim);font-size:0.88rem;margin-bottom:16px">${questions.length} soru bulundu. NasÄ±l aktarÄ±lsÄ±n?</p>
      <div class="btn-group">
        <button class="btn btn-primary" onclick="doImport('merge')">BirleÅŸtir (Mevcut + Yeni)</button>
        <button class="btn btn-danger" onclick="doImport('replace')">DeÄŸiÅŸtir (Eskiyi Sil)</button>
        <button class="btn btn-outline" onclick="closeModal()">Ä°ptal</button>
      </div>
    `;
    document.getElementById('modalOverlay').classList.add('show');

    window._importQuestions = questions;
  } catch (err) {
    showToast('Dosya okunamadÄ±: ' + err.message, 'error');
  }
  e.target.value = '';
}

async function doImport(mode) {
  const questions = window._importQuestions;
  if (!questions) return;

  if (mode === 'replace') {
    await dbClear();
  }

  for (const q of questions) {
    if (mode === 'merge') {
      q.id = Date.now().toString() + Math.random().toString(36).substr(2, 5);
    }
    if (!q.createdAt) q.createdAt = new Date().toISOString();
    await dbPut(q);
  }

  allQuestions = await dbGetAll();
  closeModal();
  updateStats();
  updateCategories();
  renderQuestionsList();
  showToast(`${questions.length} soru iÃ§e aktarÄ±ldÄ± âœ“`);
  window._importQuestions = null;
}

async function clearAllData() {
  const modal = document.getElementById('modalContent');
  modal.innerHTML = `
    <h3>âš ï¸ TÃ¼m SorularÄ± Sil</h3>
    <p style="color:var(--text-dim);font-size:0.88rem;margin-bottom:16px">${allQuestions.length} soru kalÄ±cÄ± olarak silinecek. Bu iÅŸlem geri alÄ±namaz!</p>
    <div class="btn-group">
      <button class="btn btn-danger" onclick="confirmClearAll()">Evet, Hepsini Sil</button>
      <button class="btn btn-outline" onclick="closeModal()">Ä°ptal</button>
    </div>
  `;
  document.getElementById('modalOverlay').classList.add('show');
}

async function confirmClearAll() {
  await dbClear();
  allQuestions = [];
  closeModal();
  updateStats();
  updateCategories();
  renderQuestionsList();
  showToast('TÃ¼m sorular silindi');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Utilities
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function escHTML(str) {
  const div = document.createElement('div');
  div.textContent = str || '';
  return div.innerHTML;
}

function formatDate(iso) {
  if (!iso) return '';
  const d = new Date(iso);
  return d.toLocaleDateString('tr-TR', { day: 'numeric', month: 'short', year: 'numeric' });
}

function updateStats() {
  document.getElementById('statTotal').textContent = allQuestions.length;
  document.getElementById('statMC').textContent = allQuestions.filter(q => q.type === 'mc').length;
  document.getElementById('statClassic').textContent = allQuestions.filter(q => q.type === 'classic').length;
  document.getElementById('statAudio').textContent = allQuestions.filter(q => q.type === 'audio').length;

  // Storage info
  const info = document.getElementById('storageInfo');
  info.textContent = `IndexedDB Â· ${allQuestions.length} soru kayÄ±tlÄ± Â· Veriler cihazÄ±nÄ±zda gÃ¼venle saklanÄ±yor`;
}

function updateCategories() {
  const cats = [...new Set(allQuestions.map(q => q.category).filter(Boolean))].sort();

  // Filter dropdown
  const filterCat = document.getElementById('filterCategory');
  const currentFilter = filterCat.value;
  filterCat.innerHTML = '<option value="all">TÃ¼m Kategoriler</option>';
  cats.forEach(c => filterCat.innerHTML += `<option value="${escHTML(c)}">${escHTML(c)}</option>`);
  filterCat.value = currentFilter;

  // Quiz category dropdown
  const quizCat = document.getElementById('quizCategory');
  if (quizCat) {
    const currentQuiz = quizCat.value;
    quizCat.innerHTML = '<option value="all">TÃ¼m Kategoriler</option>';
    cats.forEach(c => quizCat.innerHTML += `<option value="${escHTML(c)}">${escHTML(c)}</option>`);
    quizCat.value = currentQuiz;
  }

  // Datalist for add form
  const datalist = document.getElementById('categoryList');
  datalist.innerHTML = cats.map(c => `<option value="${escHTML(c)}">`).join('');
}

// Search & Filter events
document.getElementById('searchInput').addEventListener('input', renderQuestionsList);
document.getElementById('filterType').addEventListener('change', renderQuestionsList);
document.getElementById('filterCategory').addEventListener('change', renderQuestionsList);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Init
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function init() {
  try {
    await openDB();
    allQuestions = await dbGetAll();
    updateStats();
    updateCategories();
    renderQuestionsList();
  } catch (err) {
    showToast('VeritabanÄ± hatasÄ±: ' + err.message, 'error');
  }
}

init();
</script>

</body>
</html>

<!DOCTYPE html>

<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Bilgi YarÄ±ÅŸmasÄ±">
<meta name="theme-color" id="metaThemeColor" content="#07070f">
<link rel="manifest" id="manifestLink">
<title>Bilgi YarÄ±ÅŸmasÄ±</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
/* â•â•â• DARK (default) â•â•â• */
body {
  --bg:#07070f;--surface:#0f0f1a;--surface2:#161625;--surface3:#1e1e32;
  --border:#282845;--border-glow:#5b4cff;--primary:#6c5ce7;--primary-light:#a29bfe;
  --primary-bg:rgba(108,92,231,0.12);--accent:#fd79a8;--accent2:#00cec9;--accent3:#fdcb6e;
  --text:#eaeaf4;--text-dim:#9090b0;--text-muted:#5a5a7a;
  --success:#00b894;--danger:#ff6b6b;--warning:#feca57;--star:#f9ca24;
  --radius:16px;--radius-sm:10px;--shadow:0 8px 32px rgba(0,0,0,0.5);
  --glow:0 0 24px rgba(108,92,231,0.25);
  --grad:radial-gradient(ellipse at 25% 15%,rgba(108,92,231,0.06) 0%,transparent 55%),radial-gradient(ellipse at 75% 85%,rgba(253,121,168,0.04) 0%,transparent 55%);
}
/* â•â•â• LIGHT â•â•â• */
body.light {
  --bg:#f2f3f8;--surface:#ffffff;--surface2:#f7f7fd;--surface3:#ededf5;
  --border:#d0d0e2;--border-glow:#6c5ce7;--primary:#6c5ce7;--primary-light:#5a4bd6;
  --primary-bg:rgba(108,92,231,0.08);--accent:#e84393;--accent2:#00b5ad;--accent3:#f0932b;
  --text:#1a1a30;--text-dim:#55557a;--text-muted:#8888a8;
  --success:#00a884;--danger:#e74c3c;--warning:#f39c12;--star:#d4940e;
  --shadow:0 2px 16px rgba(0,0,20,0.07);--glow:0 0 12px rgba(108,92,231,0.1);
  --grad:radial-gradient(ellipse at 30% 20%,rgba(108,92,231,0.04) 0%,transparent 60%),radial-gradient(ellipse at 70% 80%,rgba(200,100,200,0.03) 0%,transparent 60%);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Nunito',sans-serif;background-color:var(--bg);color:var(--text);min-height:100vh;min-height:-webkit-fill-available;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background:var(--grad);pointer-events:none;z-index:0}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
.app{position:relative;z-index:1;max-width:720px;margin:0 auto;padding:12px 14px 90px;min-height:100vh}
.header{text-align:center;padding:20px 12px 14px}
.header-top{display:flex;justify-content:flex-end;align-items:center;margin-bottom:10px}
.theme-btn{width:46px;height:46px;border:1.5px solid var(--border);background:var(--surface);color:var(--text);border-radius:14px;font-size:1.3rem;cursor:pointer;display:flex;align-items:center;justify-content:center}
.header h1{font-size:1.7rem;font-weight:900;letter-spacing:-0.5px;background:linear-gradient(135deg,#a29bfe,#fd79a8,#fdcb6e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.stats-bar{display:flex;justify-content:center;gap:18px;margin-top:10px;flex-wrap:wrap}
.stat-item{text-align:center}.stat-num{font-family:'JetBrains Mono',monospace;font-size:1.2rem;font-weight:700;color:var(--primary-light)}.stat-label{font-size:.6rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:1.2px;font-weight:700}
.nav{display:flex;gap:3px;padding:5px;background:var(--surface);border-radius:var(--radius);border:1px solid var(--border);margin-bottom:14px;overflow-x:auto;-webkit-overflow-scrolling:touch}.nav::-webkit-scrollbar{display:none}
.nav-btn{flex:1;min-width:0;padding:9px 4px;border:none;background:transparent;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:.68rem;font-weight:700;border-radius:var(--radius-sm);cursor:pointer;white-space:nowrap;display:flex;flex-direction:column;align-items:center;gap:2px}
.nav-btn .ic{font-size:1.1rem}.nav-btn:hover{color:var(--text);background:var(--surface2)}.nav-btn.active{background:var(--primary);color:#fff;box-shadow:0 4px 14px rgba(108,92,231,0.35)}
.sec{display:none;animation:fu .3s ease}.sec.active{display:block}@keyframes fu{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin-bottom:12px}.card-title{font-size:.92rem;font-weight:800;margin-bottom:14px;display:flex;align-items:center;gap:8px}
.fg{margin-bottom:14px}.fl{display:block;font-size:.72rem;font-weight:700;color:var(--text-dim);margin-bottom:6px;text-transform:uppercase;letter-spacing:.8px}
.fi,.fs,.ft{width:100%;padding:12px 14px;background:var(--surface2);border:1.5px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-family:'Nunito',sans-serif;font-size:.88rem;font-weight:500;outline:none}
.fi:focus,.fs:focus,.ft:focus{border-color:var(--primary);box-shadow:0 0 0 3px var(--primary-bg)}.ft{resize:vertical;min-height:80px}
.fs{cursor:pointer;appearance:none;-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239090b0' stroke-width='2.5'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;padding-right:36px}.fs option{background:var(--surface);color:var(--text)}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:11px 20px;border:none;border-radius:var(--radius-sm);font-family:'Nunito',sans-serif;font-size:.84rem;font-weight:700;cursor:pointer}.btn:active{transform:scale(.97)}
.btn-p{background:linear-gradient(135deg,#6c5ce7,#8575f7);color:#fff;box-shadow:0 4px 16px rgba(108,92,231,0.35)}.btn-s{background:var(--success);color:#fff}.btn-d{background:var(--danger);color:#fff}.btn-w{background:var(--star);color:#1a1a2e}.btn-o{background:transparent;border:1.5px solid var(--border);color:var(--text-dim)}.btn-o:hover{border-color:var(--primary);color:var(--text)}.btn-sm{padding:8px 14px;font-size:.76rem}.btn-block{width:100%}.btn-group{display:flex;gap:8px;flex-wrap:wrap}
.opts{display:flex;flex-direction:column;gap:8px}.opt-row{display:flex;gap:8px;align-items:center}.opt-ltr{width:30px;height:30px;display:flex;align-items:center;justify-content:center;background:var(--surface3);border-radius:50%;font-size:.72rem;font-weight:800;color:var(--text-dim);flex-shrink:0}.opt-row .fi{flex:1}
.crad{width:22px;height:22px;appearance:none;-webkit-appearance:none;border:2.5px solid var(--border);border-radius:50%;cursor:pointer;flex-shrink:0;background:transparent}.crad:checked{border-color:var(--success);background:var(--success);box-shadow:inset 0 0 0 3px var(--surface2)}
.azone{background:var(--surface2);border:2px dashed var(--border);border-radius:var(--radius);padding:22px 16px;text-align:center;margin-bottom:14px}.azone.has{border-color:var(--accent);border-style:solid}.azone .big{font-size:2.2rem;margin-bottom:6px}.azone p{font-size:.76rem;color:var(--text-dim)}
.abtns{display:flex;justify-content:center;gap:10px;margin-top:12px;flex-wrap:wrap}
.rec-btn{width:52px;height:52px;border-radius:50%;border:3px solid var(--accent);background:transparent;color:var(--accent);font-size:1.2rem;cursor:pointer}.rec-btn.on{background:var(--danger);border-color:var(--danger);color:#fff;animation:pulse 1s infinite}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
.up-btn{display:inline-flex;align-items:center;gap:5px;padding:10px 18px;background:var(--surface3);border:1.5px solid var(--border);border-radius:24px;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:.78rem;font-weight:600;cursor:pointer}
.aname{font-size:.74rem;color:var(--accent);margin-top:6px;font-weight:600}
.qitem{display:flex;align-items:center;gap:10px;padding:13px 14px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-sm);margin-bottom:8px;cursor:pointer}.qitem:hover{border-color:var(--primary);transform:translateX(3px)}.qitem.starred{border-left:3px solid var(--star)}
.qicon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0}.qicon-mc{background:rgba(108,92,231,0.12)}.qicon-cl{background:rgba(0,206,201,0.12)}.qicon-au{background:rgba(253,121,168,0.12)}
.qinf{flex:1;min-width:0}.qinf .qt{font-size:.84rem;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.qinf .qm{font-size:.68rem;color:var(--text-muted);margin-top:1px;font-weight:600}
.qacts{display:flex;gap:3px;flex-shrink:0}.qab{width:34px;height:34px;border:none;background:var(--surface2);color:var(--text-dim);border-radius:8px;cursor:pointer;font-size:.82rem;display:flex;align-items:center;justify-content:center}.qab:hover{background:var(--surface3);color:var(--text)}.qab.del:hover{background:rgba(255,107,107,0.15);color:var(--danger)}.qab.sact{color:var(--star);background:rgba(249,202,36,0.12)}
.qprog{display:flex;align-items:center;gap:12px;margin-bottom:14px}.pbar{flex:1;height:7px;background:var(--surface3);border-radius:4px;overflow:hidden}.pfill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:4px;transition:width .4s}.ptxt{font-family:'JetBrains Mono',monospace;font-size:.78rem;color:var(--text-dim);white-space:nowrap;font-weight:600}
.qqcard{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:24px 20px;margin-bottom:14px;text-align:center}.qqcard .qn{font-size:.68rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:10px;font-weight:700}.qqcard .qtx{font-size:1.1rem;font-weight:700;line-height:1.55}
.qopt{display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--surface);border:2px solid var(--border);border-radius:var(--radius-sm);margin-bottom:8px;cursor:pointer;font-size:.9rem;font-weight:500}.qopt:hover{border-color:var(--primary);background:var(--surface2)}.qopt.sel{border-color:var(--primary);background:var(--primary-bg)}.qopt.ok{border-color:var(--success);background:rgba(0,184,148,0.1)}.qopt.no{border-color:var(--danger);background:rgba(255,107,107,0.1)}.qopt .ol{width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:var(--surface3);font-weight:800;font-size:.78rem;flex-shrink:0}
.qai{width:100%;padding:16px;background:var(--surface);border:2px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-family:'Nunito',sans-serif;font-size:1.05rem;font-weight:600;text-align:center;outline:none;margin-bottom:12px}.qai:focus{border-color:var(--primary)}
.rcard{text-align:center;padding:36px 20px}.rsc{font-family:'JetBrains Mono',monospace;font-size:3.5rem;font-weight:900;background:linear-gradient(135deg,var(--success),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.rbd{display:flex;justify-content:center;gap:28px;margin:20px 0}.ri .rn{font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700}.ri .rl{font-size:.68rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;font-weight:700}.ri.cok .rn{color:var(--success)}.ri.cno .rn{color:var(--danger)}
.iocard{display:flex;align-items:center;gap:14px;padding:18px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:10px;cursor:pointer}.iocard:hover{border-color:var(--primary)}.ioic{width:46px;height:46px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.3rem}
.fbar{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap}.fbar .fi{flex:1;min-width:140px;padding:10px 14px;font-size:.82rem}.fbar .fs{width:auto;min-width:110px;padding:10px 34px 10px 12px;font-size:.82rem}
.cfg{display:flex;flex-direction:column;gap:12px}.cfgo{display:flex;align-items:center;justify-content:space-between;padding:13px 16px;background:var(--surface2);border:1px solid var(--border);border-radius:var(--radius-sm)}.cfgo label{font-size:.86rem;font-weight:600}
.tog{position:relative;width:46px;height:26px;background:var(--surface3);border-radius:13px;cursor:pointer;flex-shrink:0}.tog.on{background:var(--primary)}.tog::after{content:'';position:absolute;top:3px;left:3px;width:20px;height:20px;background:#fff;border-radius:50%;transition:transform .3s}.tog.on::after{transform:translateX(20px)}
.empty{text-align:center;padding:44px 20px;color:var(--text-muted)}.empty .eic{font-size:2.8rem;margin-bottom:10px;opacity:.5}.empty p{font-size:.88rem;font-weight:500}
.toast{position:fixed;bottom:100px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:12px 22px;font-size:.84rem;font-weight:600;z-index:9999;transition:transform .3s;box-shadow:var(--shadow)}.toast.show{transform:translateX(-50%) translateY(0)}.toast.success{border-color:var(--success)}.toast.error{border-color:var(--danger)}
.mover{position:fixed;inset:0;background:rgba(0,0,0,0.65);z-index:1000;display:none;align-items:center;justify-content:center;padding:16px;backdrop-filter:blur(6px)}.mover.show{display:flex}.modal{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:22px;max-width:500px;width:100%;max-height:85vh;overflow-y:auto;animation:fu .25s}.modal h3{margin-bottom:14px;font-size:1.05rem;font-weight:800}
.bulk-info{background:var(--surface2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:14px;font-size:.76rem;color:var(--text-dim);margin-bottom:14px;line-height:1.6}
.bulk-info code{display:block;background:var(--surface3);padding:10px 12px;border-radius:8px;margin:8px 0;font-family:'JetBrains Mono',monospace;font-size:.7rem;white-space:pre-wrap;color:var(--text);line-height:1.5}
.tab-row{display:flex;gap:4px;margin-bottom:14px}.tab-btn{flex:1;padding:10px;border:1.5px solid var(--border);background:var(--surface2);color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:.8rem;font-weight:700;border-radius:var(--radius-sm);cursor:pointer}.tab-btn.active{border-color:var(--primary);color:var(--primary);background:var(--primary-bg)}
.sbadge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;background:rgba(249,202,36,0.12);border-radius:20px;font-size:.7rem;color:var(--star);font-weight:700}
.hidden{display:none!important}
@media(max-width:600px){.app{padding:8px 10px 85px}.header h1{font-size:1.4rem}.stat-num{font-size:1rem}.stats-bar{gap:12px}.card{padding:14px}.qqcard{padding:18px 14px}.rsc{font-size:2.8rem}}
</style>
<script>
// Pre-render theme to prevent flash of wrong theme
(function(){if(localStorage.getItem('quizTheme')==='light'){document.write('<style>body{--bg:#f2f3f8!important;--surface:#ffffff!important;--surface2:#f7f7fd!important;--surface3:#ededf5!important;--border:#d0d0e2!important;--text:#1a1a30!important;--text-dim:#55557a!important;--text-muted:#8888a8!important;--primary-light:#5a4bd6!important;--primary-bg:rgba(108,92,231,0.08)!important;--success:#00a884!important;--danger:#e74c3c!important;--star:#d4940e!important;--shadow:0 2px 16px rgba(0,0,20,0.07)!important;--glow:0 0 12px rgba(108,92,231,0.1)!important;--grad:radial-gradient(ellipse at 30% 20%,rgba(108,92,231,0.04) 0%,transparent 60%),radial-gradient(ellipse at 70% 80%,rgba(200,100,200,0.03) 0%,transparent 60%)!important}</style>');}})();
</script>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="header-top"><button class="theme-btn" id="themeBtn" onclick="toggleTheme()">ğŸŒ™</button></div>
    <h1>ğŸ§  Bilgi YarÄ±ÅŸmasÄ±</h1>
    <div class="stats-bar">
      <div class="stat-item"><div class="stat-num" id="sT">0</div><div class="stat-label">Toplam</div></div>
      <div class="stat-item"><div class="stat-num" id="sM">0</div><div class="stat-label">ÅÄ±klÄ±</div></div>
      <div class="stat-item"><div class="stat-num" id="sC">0</div><div class="stat-label">Klasik</div></div>
      <div class="stat-item"><div class="stat-num" id="sA">0</div><div class="stat-label">Sesli</div></div>
      <div class="stat-item"><div class="stat-num" id="sS" style="color:var(--star)">0</div><div class="stat-label">YÄ±ldÄ±zlÄ±</div></div>
    </div>
  </div>
  <div class="nav">
    <button class="nav-btn active" data-tab="questions"><span class="ic">ğŸ“‹</span>Sorular</button>
    <button class="nav-btn" data-tab="starred"><span class="ic">â­</span>YÄ±ldÄ±zlÄ±</button>
    <button class="nav-btn" data-tab="add"><span class="ic">â•</span>Ekle</button>
    <button class="nav-btn" data-tab="quiz"><span class="ic">ğŸ®</span>YarÄ±ÅŸma</button>
    <button class="nav-btn" data-tab="io"><span class="ic">ğŸ’¾</span>Aktar</button>
  </div>
  <div class="sec active" id="sec-questions">
    <div class="fbar"><input type="text" class="fi" id="srcInp" placeholder="ğŸ” Soru ara..."><select class="fs" id="fType"><option value="all">TÃ¼mÃ¼</option><option value="mc">ÅÄ±klÄ±</option><option value="classic">Klasik</option><option value="audio">Sesli</option></select><select class="fs" id="fCat"><option value="all">TÃ¼m Kategoriler</option></select></div>
    <div id="qList"></div>
  </div>
  <div class="sec" id="sec-starred">
    <div class="card" style="text-align:center;padding:14px 18px;margin-bottom:12px"><div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px"><div style="display:flex;align-items:center;gap:8px"><span style="font-size:1.3rem">â­</span><span style="font-weight:800;font-size:.92rem">YÄ±ldÄ±zlÄ± Sorular</span><span class="sbadge" id="sBadge">0</span></div><button class="btn btn-w btn-sm" onclick="startStarredQuiz()">ğŸ® YÄ±ldÄ±zlÄ±larla YarÄ±ÅŸ</button></div></div>
    <div id="sList"></div>
  </div>
  <div class="sec" id="sec-add">
    <div class="tab-row"><button class="tab-btn active" onclick="setAddMode('single',this)">ğŸ“ Tekli Ekle</button><button class="tab-btn" onclick="setAddMode('bulk',this)">ğŸ“‹ Toplu Ekle</button></div>
    <div id="singleAdd">
      <div class="card">
        <div class="card-title">Yeni Soru Ekle</div>
        <div class="fg"><label class="fl">Soru Tipi</label><select class="fs" id="addType" onchange="onTypeChg()"><option value="mc">ğŸ“ ÅÄ±klÄ± Soru</option><option value="classic">âœï¸ Klasik Soru</option><option value="audio">ğŸµ Sesli Soru</option></select></div>
        <div class="fg"><label class="fl">Kategori</label><input type="text" class="fi" id="addCat" placeholder="Ã–rn: Tarih, CoÄŸrafya..." list="catDL"><datalist id="catDL"></datalist></div>
        <div class="fg"><label class="fl">Soru Metni</label><textarea class="ft" id="addQ" placeholder="Sorunuzu yazÄ±n..."></textarea></div>
        <div id="mcOpts"><label class="fl">ÅÄ±klar <span style="font-weight:400;color:var(--text-muted)">(doÄŸruyu iÅŸaretleyin)</span></label><div class="opts" id="optsC"><div class="opt-row"><div class="opt-ltr">A</div><input type="text" class="fi" placeholder="A ÅŸÄ±kkÄ±"><input type="radio" name="copt" value="0" class="crad" checked></div><div class="opt-row"><div class="opt-ltr">B</div><input type="text" class="fi" placeholder="B ÅŸÄ±kkÄ±"><input type="radio" name="copt" value="1" class="crad"></div><div class="opt-row"><div class="opt-ltr">C</div><input type="text" class="fi" placeholder="C ÅŸÄ±kkÄ±"><input type="radio" name="copt" value="2" class="crad"></div><div class="opt-row"><div class="opt-ltr">D</div><input type="text" class="fi" placeholder="D ÅŸÄ±kkÄ±"><input type="radio" name="copt" value="3" class="crad"></div></div></div>
        <div id="clAns" class="hidden"><div class="fg"><label class="fl">DoÄŸru Cevap</label><input type="text" class="fi" id="addAns" placeholder="CevabÄ± yazÄ±n..."></div><div class="fg"><label class="fl">Ä°pucu (Opsiyonel)</label><input type="text" class="fi" id="addHint" placeholder="Ä°pucu..."></div></div>
        <div id="auSec" class="hidden"><div class="azone" id="aZone"><div class="big">ğŸ¤</div><p>Ses kaydÄ± veya dosya yÃ¼kleyin</p><p style="font-size:.68rem;color:var(--text-muted);margin-top:3px">MP3, M4A, WAV, OGG, AAC</p><div class="abtns"><button class="rec-btn" id="recBtn" onclick="toggleRec()">âº</button><button class="up-btn" onclick="document.getElementById('auFile').click()">ğŸ“ Dosya YÃ¼kle</button><input type="file" id="auFile" class="hidden" accept="audio/*,.mp3,.m4a,.wav,.ogg,.aac,.wma,.flac,.opus,.webm" onchange="handleAU(event)"></div><div id="auName" class="aname hidden"></div><audio id="auPrev" controls class="hidden" style="width:100%;margin-top:10px"></audio></div><div class="fg"><label class="fl">DoÄŸru Cevap</label><input type="text" class="fi" id="addAuAns" placeholder="CevabÄ± yazÄ±n..."></div></div>
        <div style="margin-top:18px"><button class="btn btn-p btn-block" onclick="saveQ()" id="saveBtn">ğŸ’¾ Soruyu Kaydet</button></div>
      </div>
    </div>
    <div id="bulkAdd" class="hidden">
      <div class="card">
        <div class="card-title">ğŸ“‹ Toplu Soru Ekle</div>
        <div class="bulk-info">Her satÄ±ra bir soru yazÄ±n:<code>ÅIKLI: Soru? | A ÅŸÄ±kkÄ± | B ÅŸÄ±kkÄ± | C ÅŸÄ±kkÄ± | D ÅŸÄ±kkÄ± | A
KLASÄ°K: Soru? | Cevap
KLASÄ°K: Soru? | Cevap | Ä°pucu</code>Ya da otomatik algÄ±lama (baÅŸlÄ±k olmadan):<code>BaÅŸkent neresi? | Ankara | Ä°stanbul | Ä°zmir | Bursa | A
En bÃ¼yÃ¼k okyanus? | BÃ¼yÃ¼k Okyanus</code></div>
        <div class="fg"><label class="fl">Kategori</label><input type="text" class="fi" id="bulkCat" placeholder="Genel KÃ¼ltÃ¼r" list="catDL"></div>
        <div class="fg"><label class="fl">SorularÄ± YapÄ±ÅŸtÄ±rÄ±n</label><textarea class="ft" id="bulkText" placeholder="Her satÄ±ra bir soru..." style="min-height:200px;font-size:.8rem"></textarea></div>
        <div id="bulkPrev" class="hidden" style="margin-bottom:14px"></div>
        <div class="btn-group"><button class="btn btn-o" onclick="prevBulk()">ğŸ‘ï¸ Ã–nizle</button><button class="btn btn-p btn-block" onclick="saveBulk()">ğŸ’¾ Toplu Kaydet</button></div>
      </div>
    </div>
  </div>
  <div class="sec" id="sec-quiz">
    <div id="qSetup"><div class="card"><div class="card-title">ğŸ® YarÄ±ÅŸma AyarlarÄ±</div><div class="cfg"><div class="fg"><label class="fl">Soru SayÄ±sÄ±</label><input type="number" class="fi" id="qzCnt" value="10" min="1" max="999"></div><div class="fg"><label class="fl">Soru Tipi</label><select class="fs" id="qzType"><option value="all">TÃ¼m Tipler</option><option value="mc">ÅÄ±klÄ±</option><option value="classic">Klasik</option><option value="audio">Sesli</option></select></div><div class="fg"><label class="fl">Kategori</label><select class="fs" id="qzCat"><option value="all">TÃ¼m Kategoriler</option></select></div><div class="cfgo"><label>SorularÄ± KarÄ±ÅŸtÄ±r</label><div class="tog on" id="togShuf" onclick="this.classList.toggle('on')"></div></div><div class="cfgo"><label>â­ Sadece YÄ±ldÄ±zlÄ±lar</label><div class="tog" id="togStar" onclick="this.classList.toggle('on')"></div></div></div><div style="margin-top:18px"><button class="btn btn-p btn-block" onclick="startQuiz()">ğŸš€ BaÅŸlat</button></div></div></div>
    <div id="qPlay" class="hidden"><div class="qprog"><div class="pbar"><div class="pfill" id="pFill"></div></div><div class="ptxt" id="pTxt">1/10</div></div><div id="qCont"></div><div id="qActs" style="margin-top:14px;text-align:center"></div></div>
    <div id="qRes" class="hidden"></div>
  </div>
  <div class="sec" id="sec-io">
    <div class="iocard" onclick="exportData()"><div class="ioic" style="background:rgba(0,184,148,0.12)">ğŸ“¤</div><div><div style="font-size:.9rem;font-weight:700">DÄ±ÅŸa Aktar</div><div style="font-size:.75rem;color:var(--text-dim);margin-top:2px">JSON olarak indir</div></div></div>
    <div class="iocard" onclick="document.getElementById('impFile').click()"><div class="ioic" style="background:rgba(108,92,231,0.12)">ğŸ“¥</div><div><div style="font-size:.9rem;font-weight:700">Ä°Ã§e Aktar</div><div style="font-size:.75rem;color:var(--text-dim);margin-top:2px">JSON dosyasÄ±ndan yÃ¼kle</div></div></div>
    <input type="file" id="impFile" class="hidden" accept=".json" onchange="importData(event)">
    <div class="card" style="margin-top:14px"><div class="card-title">âš ï¸ Tehlikeli BÃ¶lge</div><p style="font-size:.8rem;color:var(--text-dim);margin-bottom:12px">Geri alÄ±namaz.</p><button class="btn btn-d btn-sm" onclick="clearAll()">ğŸ—‘ï¸ TÃ¼m SorularÄ± Sil</button></div>
    <div class="card" style="margin-top:10px"><div class="card-title">â„¹ï¸ Depolama</div><p style="font-size:.8rem;color:var(--text-dim)" id="stInfo">YÃ¼kleniyor...</p></div>
  </div>
</div>
<div class="toast" id="toast"></div>
<div class="mover" id="mOver"><div class="modal" id="mCont"></div></div>
<script>
// â•â•â• THEME â•â•â•
function toggleTheme(){
  var b=document.body,isL=b.classList.contains('light');
  if(isL){b.classList.remove('light');document.getElementById('themeBtn').textContent='ğŸŒ™';document.getElementById('metaThemeColor').content='#07070f';localStorage.setItem('quizTheme','dark');}
  else{b.classList.add('light');document.getElementById('themeBtn').textContent='â˜€ï¸';document.getElementById('metaThemeColor').content='#f2f3f8';localStorage.setItem('quizTheme','light');}
}
if(localStorage.getItem('quizTheme')==='light'){document.body.classList.add('light');document.getElementById('themeBtn').textContent='â˜€ï¸';document.getElementById('metaThemeColor').content='#f2f3f8';}

// â•â•â• PWA â•â•â•
var MF={name:â€œBilgi YarÄ±ÅŸmasÄ±â€,short_name:â€œBilgi Quizâ€,start_url:location.href,display:â€œstandaloneâ€,background_color:â€#07070fâ€,theme_color:â€#6c5ce7â€,icons:[{src:â€œdata:image/svg+xml,â€+encodeURIComponent(â€<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect fill='#6c5ce7' width='512' height='512' rx='100'/><text y='340' x='256' text-anchor='middle' font-size='280'>ğŸ§ </text></svg>â€),sizes:â€œ512x512â€,type:â€œimage/svg+xmlâ€}]};
document.getElementById(â€˜manifestLinkâ€™).href=URL.createObjectURL(new Blob([JSON.stringify(MF)],{type:â€˜application/jsonâ€™}));
if(â€˜serviceWorkerâ€™ in navigator){navigator.serviceWorker.register(URL.createObjectURL(new Blob([`self.addEventListener('install',e=>self.skipWaiting());self.addEventListener('activate',e=>e.waitUntil(clients.claim()));self.addEventListener('fetch',e=>{if(e.request.method!=='GET')return;e.respondWith(fetch(e.request).then(r=>{if(r&&r.status===200){var c=r.clone();caches.open('bq3').then(x=>x.put(e.request,c))}return r}).catch(()=>caches.match(e.request)))})`],{type:â€˜application/javascriptâ€™}))).catch(()=>{});}

// â•â•â• DB â•â•â•
var DB=â€˜BilgiYarismasiâ€™,VER=2,ST=â€˜questionsâ€™,db=null;
function openDB(){return new Promise(function(r,j){var q=indexedDB.open(DB,VER);q.onupgradeneeded=function(e){var d=e.target.result;if(!d.objectStoreNames.contains(ST)){var s=d.createObjectStore(ST,{keyPath:â€˜idâ€™});s.createIndex(â€˜typeâ€™,â€˜typeâ€™);s.createIndex(â€˜categoryâ€™,â€˜categoryâ€™);s.createIndex(â€˜starredâ€™,â€˜starredâ€™);}else{var s=e.currentTarget.transaction.objectStore(ST);if(!s.indexNames.contains(â€˜starredâ€™))s.createIndex(â€˜starredâ€™,â€˜starredâ€™);}};q.onsuccess=function(e){db=e.target.result;r(db)};q.onerror=function(e){j(e.target.error)}})}
function xt(m){return db.transaction(ST,m||â€˜readonlyâ€™).objectStore(ST)}
function dbAll(){return new Promise(function(r,j){var q=xt().getAll();q.onsuccess=function(){r(q.result)};q.onerror=function(){j(q.error)}})}
function dbPut(i){return new Promise(function(r,j){var q=xt(â€˜readwriteâ€™).put(i);q.onsuccess=function(){r()};q.onerror=function(){j(q.error)}})}
function dbDel(id){return new Promise(function(r,j){var q=xt(â€˜readwriteâ€™).delete(id);q.onsuccess=function(){r()};q.onerror=function(){j(q.error)}})}
function dbClr(){return new Promise(function(r,j){var q=xt(â€˜readwriteâ€™).clear();q.onsuccess=function(){r()};q.onerror=function(){j(q.error)}})}

var ALL=[],editId=null,curAudio=null,mediaRec=null,auChunks=[],isRec=false;
var QZ=[],QI=0,QSC=0,QAd=false,QAs=[],selMC=-1;

// â•â•â• NAV â•â•â•
document.querySelectorAll(â€™.nav-btnâ€™).forEach(function(b){b.addEventListener(â€˜clickâ€™,function(){document.querySelectorAll(â€™.nav-btnâ€™).forEach(function(x){x.classList.remove(â€˜activeâ€™)});document.querySelectorAll(â€™.secâ€™).forEach(function(x){x.classList.remove(â€˜activeâ€™)});b.classList.add(â€˜activeâ€™);document.getElementById(â€˜sec-â€™+b.dataset.tab).classList.add(â€˜activeâ€™);if(b.dataset.tab===â€˜questionsâ€™)renderList();if(b.dataset.tab===â€˜starredâ€™)renderStarred();if(b.dataset.tab===â€˜quizâ€™)resetQzUI();})});
function switchTab(t){document.querySelectorAll(â€™.nav-btnâ€™).forEach(function(b){b.classList.toggle(â€˜activeâ€™,b.dataset.tab===t)});document.querySelectorAll(â€™.secâ€™).forEach(function(s){s.classList.toggle(â€˜activeâ€™,s.id===â€˜sec-â€™+t)})}
function toast(m,t){var e=document.getElementById(â€˜toastâ€™);e.textContent=m;e.className=â€˜toast â€˜+(t||â€˜successâ€™)+â€™ showâ€™;setTimeout(function(){e.classList.remove(â€˜showâ€™)},2500)}
function showM(h){document.getElementById(â€˜mContâ€™).innerHTML=h;document.getElementById(â€˜mOverâ€™).classList.add(â€˜showâ€™)}
function closeM(){document.getElementById(â€˜mOverâ€™).classList.remove(â€˜showâ€™)}
document.getElementById(â€˜mOverâ€™).addEventListener(â€˜clickâ€™,function(e){if(e.target===e.currentTarget)closeM()});
function setAddMode(m,btn){document.querySelectorAll(â€™.tab-btnâ€™).forEach(function(b){b.classList.remove(â€˜activeâ€™)});btn.classList.add(â€˜activeâ€™);document.getElementById(â€˜singleAddâ€™).classList.toggle(â€˜hiddenâ€™,m===â€˜bulkâ€™);document.getElementById(â€˜bulkAddâ€™).classList.toggle(â€˜hiddenâ€™,m===â€˜singleâ€™)}
function onTypeChg(){var t=document.getElementById(â€˜addTypeâ€™).value;document.getElementById(â€˜mcOptsâ€™).classList.toggle(â€˜hiddenâ€™,t!==â€˜mcâ€™);document.getElementById(â€˜clAnsâ€™).classList.toggle(â€˜hiddenâ€™,t!==â€˜classicâ€™);document.getElementById(â€˜auSecâ€™).classList.toggle(â€˜hiddenâ€™,t!==â€˜audioâ€™)}

// â•â•â• AUDIO â•â•â•
function toggleRec(){var btn=document.getElementById(â€˜recBtnâ€™);if(!isRec){navigator.mediaDevices.getUserMedia({audio:true}).then(function(stream){var mime=[â€˜audio/webm;codecs=opusâ€™,â€˜audio/webmâ€™,â€˜audio/mp4â€™,â€˜audio/wavâ€™].find(function(t){return MediaRecorder.isTypeSupported(t)})||â€™â€™;mediaRec=new MediaRecorder(stream,mime?{mimeType:mime}:{});auChunks=[];mediaRec.ondataavailable=function(e){if(e.data.size>0)auChunks.push(e.data)};mediaRec.onstop=function(){var blob=new Blob(auChunks,{type:mediaRec.mimeType});stream.getTracks().forEach(function(t){t.stop()});toUrl(blob).then(function(u){curAudio=u;showAuP(u,â€˜Mikrofon KaydÄ±â€™)})};mediaRec.start();isRec=true;btn.classList.add(â€˜onâ€™);btn.textContent=â€˜â¹â€™}).catch(function(){toast(â€˜Mikrofon reddedildi!â€™,â€˜errorâ€™)})}else{mediaRec.stop();isRec=false;btn.classList.remove(â€˜onâ€™);btn.textContent=â€˜âºâ€™}}
function handleAU(e){var f=e.target.files[0];if(!f)return;if(f.size>15*1024*1024){toast(â€˜Maks 15MB!â€™,â€˜errorâ€™);return}toUrl(f).then(function(u){curAudio=u;showAuP(u,f.name)});e.target.value=â€™â€™}
function toUrl(b){return new Promise(function(r,j){var rd=new FileReader();rd.onload=function(){r(rd.result)};rd.onerror=function(){j(rd.error)};rd.readAsDataURL(b)})}
function showAuP(url,name){var z=document.getElementById(â€˜aZoneâ€™),p=document.getElementById(â€˜auPrevâ€™),n=document.getElementById(â€˜auNameâ€™);p.src=url;p.classList.remove(â€˜hiddenâ€™);z.classList.add(â€˜hasâ€™);if(name){n.textContent=â€™ğŸµ â€™+name;n.classList.remove(â€˜hiddenâ€™)}toast(â€˜Ses yÃ¼klendi âœ“â€™)}

// â•â•â• STAR â•â•â•
function toggleStar(id,ev){if(ev)ev.stopPropagation();var q=ALL.find(function(x){return x.id===id});if(!q)return;q.starred=!q.starred;dbPut(q).then(function(){return dbAll()}).then(function(a){ALL=a;stats();renderList();renderStarred();toast(q.starred?â€˜â­ YÄ±ldÄ±zlandÄ±â€™:â€˜KaldÄ±rÄ±ldÄ±â€™)})}

// â•â•â• SAVE â•â•â•
function uid(){return Date.now().toString(36)+Math.random().toString(36).substr(2,6)}
function saveQ(){var type=document.getElementById(â€˜addTypeâ€™).value,cat=document.getElementById(â€˜addCatâ€™).value.trim()||â€˜Genelâ€™,qtxt=document.getElementById(â€˜addQâ€™).value.trim();if(!qtxt){toast(â€˜Soru boÅŸ!â€™,â€˜errorâ€™);return}
var q={id:editId||uid(),type:type,category:cat,question:qtxt,starred:false,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};
if(editId){var ex=ALL.find(function(x){return x.id===editId});if(ex){q.createdAt=ex.createdAt;q.starred=ex.starred}}
if(type===â€˜mcâ€™){var ins=document.querySelectorAll(â€™#optsC .fiâ€™),opts=Array.from(ins).map(function(i){return i.value.trim()});if(opts.some(function(o){return!o})){toast(â€˜ÅÄ±klarÄ± doldurun!â€™,â€˜errorâ€™);return}q.options=opts;q.correctIndex=parseInt(document.querySelector(â€˜input[name=â€œcoptâ€]:checkedâ€™).value)}
else if(type===â€˜classicâ€™){var a=document.getElementById(â€˜addAnsâ€™).value.trim();if(!a){toast(â€˜Cevap girin!â€™,â€˜errorâ€™);return}q.answer=a;q.hint=document.getElementById(â€˜addHintâ€™).value.trim()}
else{var a=document.getElementById(â€˜addAuAnsâ€™).value.trim();if(!a){toast(â€˜Cevap girin!â€™,â€˜errorâ€™);return}if(!curAudio&&!editId){toast(â€˜Ses ekleyin!â€™,â€˜errorâ€™);return}q.answer=a;if(curAudio)q.audioData=curAudio;else if(editId){var ex=ALL.find(function(x){return x.id===editId});if(ex&&ex.audioData)q.audioData=ex.audioData}}
dbPut(q).then(function(){return dbAll()}).then(function(a){ALL=a;toast(editId?â€˜GÃ¼ncellendi âœ“â€™:â€˜Kaydedildi âœ“â€™);resetForm();stats();cats()})}
function resetForm(){editId=null;curAudio=null;document.getElementById(â€˜addTypeâ€™).value=â€˜mcâ€™;document.getElementById(â€˜addCatâ€™).value=â€™â€™;document.getElementById(â€˜addQâ€™).value=â€™â€™;document.getElementById(â€˜addAnsâ€™).value=â€™â€™;document.getElementById(â€˜addHintâ€™).value=â€™â€™;document.getElementById(â€˜addAuAnsâ€™).value=â€™â€™;document.querySelectorAll(â€™#optsC .fiâ€™).forEach(function(i){i.value=â€™â€™});document.querySelector(â€˜input[name=â€œcoptâ€][value=â€œ0â€]â€™).checked=true;document.getElementById(â€˜auPrevâ€™).classList.add(â€˜hiddenâ€™);document.getElementById(â€˜auPrevâ€™).src=â€™â€™;document.getElementById(â€˜auNameâ€™).classList.add(â€˜hiddenâ€™);document.getElementById(â€˜aZoneâ€™).classList.remove(â€˜hasâ€™);document.getElementById(â€˜saveBtnâ€™).textContent=â€˜ğŸ’¾ Soruyu Kaydetâ€™;onTypeChg()}

// â•â•â• BULK â•â•â•
function parseBulk(){var text=document.getElementById(â€˜bulkTextâ€™).value.trim(),cat=document.getElementById(â€˜bulkCatâ€™).value.trim()||â€˜Genelâ€™;if(!text)return[];var lines=text.split(â€™\nâ€™).filter(function(l){return l.trim()}),res=[];
lines.forEach(function(line){var l=line.trim(),up=l.toUpperCase();
if(up.startsWith(â€˜ÅIKLI:â€™)||up.startsWith(â€˜SIKLI:â€™)){var p=l.substring(l.indexOf(â€™:â€™)+1).split(â€™|â€™).map(function(s){return s.trim()});if(p.length>=6){var c={â€˜Aâ€™:0,â€˜Bâ€™:1,â€˜Câ€™:2,â€˜Dâ€™:3}[p[5].toUpperCase()];if(c===undefined)c=0;res.push({type:â€˜mcâ€™,category:cat,question:p[0],options:[p[1],p[2],p[3],p[4]],correctIndex:c,starred:false})}}
else if(up.startsWith(â€˜KLASÄ°K:â€™)||up.startsWith(â€˜KLASIK:â€™)){var p=l.substring(l.indexOf(â€™:â€™)+1).split(â€™|â€™).map(function(s){return s.trim()});if(p.length>=2)res.push({type:â€˜classicâ€™,category:cat,question:p[0],answer:p[1],hint:p[2]||â€™â€™,starred:false})}
else{var p=l.split(â€™|â€™).map(function(s){return s.trim()});if(p.length>=6){var last=p[p.length-1].toUpperCase(),c={â€˜Aâ€™:0,â€˜Bâ€™:1,â€˜Câ€™:2,â€˜Dâ€™:3}[last];if(c!==undefined)res.push({type:â€˜mcâ€™,category:cat,question:p[0],options:[p[1],p[2],p[3],p[4]],correctIndex:c,starred:false})}else if(p.length>=2)res.push({type:â€˜classicâ€™,category:cat,question:p[0],answer:p[1],hint:p[2]||â€™â€™,starred:false})}
});return res}
function prevBulk(){var qs=parseBulk(),el=document.getElementById(â€˜bulkPrevâ€™);if(!qs.length){el.classList.add(â€˜hiddenâ€™);toast(â€˜GeÃ§erli soru yok!â€™,â€˜errorâ€™);return}el.classList.remove(â€˜hiddenâ€™);
el.innerHTML=â€™<div class="card" style="padding:14px"><div class="card-title">ğŸ‘ï¸ Ã–nizleme (â€™+qs.length+â€™ soru)</div>â€™+qs.map(function(q,i){returnâ€™<div style="padding:8px 0;border-bottom:1px solid var(--border);font-size:.82rem"><strong>â€™+(i+1)+â€™.</strong> â€˜+esc(q.question)+â€™ <span style="color:var(--text-muted)">[â€™+(q.type===â€˜mcâ€™?â€˜ÅÄ±klÄ±â€™:â€˜Klasikâ€™)+â€™]</span><div style="color:var(--success);font-size:.76rem;margin-top:2px">âœ“ â€˜+esc(q.type===â€˜mcâ€™?q.options[q.correctIndex]:q.answer)+â€™</div></div>â€™}).join(â€™â€™)+â€™</div>â€™}
function saveBulk(){var qs=parseBulk();if(!qs.length){toast(â€˜Soru yok!â€™,â€˜errorâ€™);return}var chain=Promise.resolve();qs.forEach(function(q){q.id=uid();q.createdAt=new Date().toISOString();q.updatedAt=new Date().toISOString();chain=chain.then(function(){return dbPut(q)})});chain.then(function(){return dbAll()}).then(function(a){ALL=a;stats();cats();renderList();document.getElementById(â€˜bulkTextâ€™).value=â€™â€™;document.getElementById(â€˜bulkPrevâ€™).classList.add(â€˜hiddenâ€™);toast(qs.length+â€™ soru eklendi âœ“â€™)})}

// â•â•â• EDIT/DEL â•â•â•
function editQ(id){var q=ALL.find(function(x){return x.id===id});if(!q)return;editId=id;switchTab(â€˜addâ€™);setAddMode(â€˜singleâ€™,document.querySelector(â€™.tab-btnâ€™));
document.getElementById(â€˜addTypeâ€™).value=q.type;document.getElementById(â€˜addCatâ€™).value=q.category||â€™â€™;document.getElementById(â€˜addQâ€™).value=q.question;onTypeChg();
if(q.type===â€˜mcâ€™){var ins=document.querySelectorAll(â€™#optsC .fiâ€™);q.options.forEach(function(o,i){if(ins[i])ins[i].value=o});var r=document.querySelector(â€˜input[name=â€œcoptâ€][value=â€â€™+q.correctIndex+â€™â€]â€™);if(r)r.checked=true}
else if(q.type===â€˜classicâ€™){document.getElementById(â€˜addAnsâ€™).value=q.answer||â€™â€™;document.getElementById(â€˜addHintâ€™).value=q.hint||â€™â€™}
else{document.getElementById(â€˜addAuAnsâ€™).value=q.answer||â€™â€™;if(q.audioData){curAudio=q.audioData;showAuP(q.audioData,â€˜Mevcut sesâ€™)}}
document.getElementById(â€˜saveBtnâ€™).textContent=â€˜âœï¸ GÃ¼ncelleâ€™;window.scrollTo({top:0,behavior:â€˜smoothâ€™})}
function delQ(id){var q=ALL.find(function(x){return x.id===id});if(!q)return;showM(â€™<h3>âš ï¸ Sil</h3><p style="color:var(--text-dim);font-size:.84rem;margin-bottom:14px">â€â€™+esc(q.question.substring(0,80))+â€™â€</p><div class="btn-group"><button class="btn btn-d btn-sm" onclick="confirmDel(\''+id+'\')">Sil</button><button class="btn btn-o btn-sm" onclick="closeM()">Ä°ptal</button></div>â€™)}
function confirmDel(id){dbDel(id).then(function(){return dbAll()}).then(function(a){ALL=a;closeM();stats();cats();renderList();renderStarred();toast(â€˜Silindiâ€™)})}

// â•â•â• RENDER â•â•â•
function renderList(){var s=document.getElementById(â€˜srcInpâ€™).value.toLowerCase(),tf=document.getElementById(â€˜fTypeâ€™).value,cf=document.getElementById(â€˜fCatâ€™).value;
var f=ALL.filter(function(q){if(tf!==â€˜allâ€™&&q.type!==tf)return false;if(cf!==â€˜allâ€™&&q.category!==cf)return false;if(s&&!q.question.toLowerCase().includes(s))return false;return true}).sort(function(a,b){return new Date(b.createdAt)-new Date(a.createdAt)});
var c=document.getElementById(â€˜qListâ€™);if(!f.length){c.innerHTML=â€™<div class="empty"><div class="eic">ğŸ“­</div><p>â€™+(ALL.length===0?â€˜HenÃ¼z soru yok.<br>â€œEkleâ€ sekmesinden baÅŸlayÄ±n!â€™:â€˜SonuÃ§ bulunamadÄ±.â€™)+â€™</p></div>â€™;return}c.innerHTML=f.map(qH).join(â€™â€™)}
function renderStarred(){var st=ALL.filter(function(q){return q.starred}).sort(function(a,b){return new Date(b.updatedAt)-new Date(a.updatedAt)});document.getElementById(â€˜sBadgeâ€™).textContent=st.length;var c=document.getElementById(â€˜sListâ€™);if(!st.length){c.innerHTML=â€™<div class="empty"><div class="eic">â­</div><p>YÄ±ldÄ±zlÄ± soru yok.<br>BilemediÄŸiniz sorularÄ± yÄ±ldÄ±zlayÄ±n!</p></div>â€™;return}c.innerHTML=st.map(qH).join(â€™â€™)}
function qH(q){var ic={mc:â€˜ğŸ“â€™,classic:â€˜âœï¸â€™,audio:â€˜ğŸµâ€™},cl={mc:â€˜qicon-mcâ€™,classic:â€˜qicon-clâ€™,audio:â€˜qicon-auâ€™},lb={mc:â€˜ÅÄ±klÄ±â€™,classic:â€˜Klasikâ€™,audio:â€˜Sesliâ€™};returnâ€™<div class="qitem'+(q.starred?' starred':'')+'" onclick="prevQ(\''+q.id+'\')"><div class="qicon '+cl[q.type]+'">â€™+ic[q.type]+â€™</div><div class="qinf"><div class="qt">â€™+(q.starred?â€˜â­ â€˜:â€™â€™)+esc(q.question)+â€™</div><div class="qm">â€™+lb[q.type]+â€™ Â· â€˜+esc(q.category||â€˜Genelâ€™)+â€™ Â· â€˜+fmtD(q.createdAt)+â€™</div></div><div class="qacts" onclick="event.stopPropagation()"><button class="qab '+(q.starred?'sact':'')+'" onclick="toggleStar(\''+q.id+'\',event)">â€™+(q.starred?â€˜â˜…â€™:â€˜â˜†â€™)+â€™</button><button class="qab" onclick="editQ(\''+q.id+'\')">âœï¸</button><button class="qab del" onclick="delQ(\''+q.id+'\')">ğŸ—‘ï¸</button></div></div>â€™}
function prevQ(id){var q=ALL.find(function(x){return x.id===id});if(!q)return;var L=[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™,â€˜Dâ€™,â€˜Eâ€™];var h=â€™<h3>â€™+esc(q.question)+â€™</h3><p style="font-size:.74rem;color:var(--text-muted);margin-bottom:14px">â€™+(q.type===â€˜mcâ€™?â€˜ÅÄ±klÄ±â€™:q.type===â€˜classicâ€™?â€˜Klasikâ€™:â€˜Sesliâ€™)+â€™ Â· â€˜+esc(q.category||â€˜Genelâ€™)+(q.starred?â€™ Â· â­â€™:â€™â€™)+â€™</p>â€™;
if(q.type===â€˜mcâ€™)h+=q.options.map(function(o,i){returnâ€™<div style="padding:8px 12px;margin-bottom:4px;border-radius:8px;font-size:.86rem;'+(i===q.correctIndex?'background:rgba(0,184,148,0.1);color:var(--success);font-weight:700':'color:var(--text-dim)')+'">â€™+L[i]+â€™) â€˜+esc(o)+(i===q.correctIndex?â€™ âœ“â€™:â€™â€™)+â€™</div>â€™}).join(â€™â€™);
else if(q.type===â€˜classicâ€™){h+=â€™<div style="padding:10px 14px;background:rgba(0,184,148,0.08);border-radius:8px;margin-bottom:8px"><span style="font-size:.7rem;color:var(--text-muted)">CEVAP:</span><br><span style="color:var(--success);font-weight:700">â€™+esc(q.answer)+â€™</span></div>â€™;if(q.hint)h+=â€™<p style="font-size:.8rem;color:var(--text-dim)">ğŸ’¡ â€˜+esc(q.hint)+â€™</p>â€™}
else{if(q.audioData)h+=â€™<audio controls src="'+q.audioData+'" style="width:100%;margin:8px 0"></audio>â€™;h+=â€™<div style="padding:10px 14px;background:rgba(0,184,148,0.08);border-radius:8px"><span style="font-size:.7rem;color:var(--text-muted)">CEVAP:</span><br><span style="color:var(--success);font-weight:700">â€™+esc(q.answer)+â€™</span></div>â€™}
h+=â€™<div class="btn-group" style="margin-top:16px"><button class="btn btn-o btn-sm" onclick="closeM()">Kapat</button><button class="btn btn-sm '+(q.starred?'btn-w':'btn-o')+'" onclick="closeM();toggleStar(\''+q.id+'\')">â€™+(q.starred?â€˜â˜… KaldÄ±râ€™:â€˜â˜† YÄ±ldÄ±zlaâ€™)+â€™</button><button class="btn btn-p btn-sm" onclick="closeM();editQ(\''+q.id+'\')">âœï¸ DÃ¼zenle</button></div>â€™;showM(h)}

// â•â•â• QUIZ â•â•â•
function resetQzUI(){document.getElementById(â€˜qSetupâ€™).classList.remove(â€˜hiddenâ€™);document.getElementById(â€˜qPlayâ€™).classList.add(â€˜hiddenâ€™);document.getElementById(â€˜qResâ€™).classList.add(â€˜hiddenâ€™);cats()}
function startStarredQuiz(){var st=ALL.filter(function(q){return q.starred});if(!st.length){toast(â€˜YÄ±ldÄ±zlÄ± soru yok!â€™,â€˜errorâ€™);return}switchTab(â€˜quizâ€™);document.getElementById(â€˜togStarâ€™).classList.add(â€˜onâ€™);setTimeout(startQuiz,100)}
function startQuiz(){var cnt=parseInt(document.getElementById(â€˜qzCntâ€™).value)||10,tf=document.getElementById(â€˜qzTypeâ€™).value,cf=document.getElementById(â€˜qzCatâ€™).value,shuf=document.getElementById(â€˜togShufâ€™).classList.contains(â€˜onâ€™),starO=document.getElementById(â€˜togStarâ€™).classList.contains(â€˜onâ€™);
var pool=ALL.filter(function(q){if(tf!==â€˜allâ€™&&q.type!==tf)return false;if(cf!==â€˜allâ€™&&q.category!==cf)return false;if(starO&&!q.starred)return false;return true});
if(!pool.length){toast(â€˜Soru yok!â€™,â€˜errorâ€™);return}if(shuf)pool.sort(function(){return Math.random()-.5});QZ=pool.slice(0,cnt);QI=0;QSC=0;QAd=false;QAs=[];
document.getElementById(â€˜qSetupâ€™).classList.add(â€˜hiddenâ€™);document.getElementById(â€˜qPlayâ€™).classList.remove(â€˜hiddenâ€™);document.getElementById(â€˜qResâ€™).classList.add(â€˜hiddenâ€™);renderQzQ()}
function renderQzQ(){var q=QZ[QI],tot=QZ.length;QAd=false;selMC=-1;document.getElementById(â€˜pFillâ€™).style.width=((QI/tot)*100)+â€™%â€™;document.getElementById(â€˜pTxtâ€™).textContent=(QI+1)+â€™/â€™+tot;
var L=[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™,â€˜Dâ€™,â€˜Eâ€™],h=â€™<div class="qqcard"><div class="qn">Soru â€˜+(QI+1)+â€™/â€™+tot+â€™ Â· â€˜+(q.type===â€˜mcâ€™?â€˜ÅÄ±klÄ±â€™:q.type===â€˜classicâ€™?â€˜Klasikâ€™:â€˜Sesliâ€™)+(q.starred?â€™ â­â€™:â€™â€™)+â€™</div>â€™;
if(q.type===â€˜audioâ€™&&q.audioData)h+=â€™<audio controls src="'+q.audioData+'" style="width:100%;margin:10px auto;max-width:400px;display:block"></audio>â€™;
h+=â€™<div class="qtx">â€™+esc(q.question)+â€™</div></div>â€™;
if(q.type===â€˜mcâ€™){h+=q.options.map(function(o,i){returnâ€™<div class="qopt" onclick="selOpt('+i+')"><div class="ol">â€™+L[i]+â€™</div><span>â€™+esc(o)+â€™</span></div>â€™}).join(â€™â€™);document.getElementById(â€˜qActsâ€™).innerHTML=â€™<button class="btn btn-p" onclick="chkMC()" id="chkB" disabled>CevabÄ± Kontrol Et</button>â€™}
else{if(q.hint)h+=â€™<p style="font-size:.8rem;color:var(--text-dim);margin-bottom:8px;text-align:center">ğŸ’¡ â€˜+esc(q.hint)+â€™</p>â€™;h+=â€™<input type="text" class="qai" id="qzInp" placeholder="CevabÄ±nÄ±zÄ± yazÄ±n..." onkeydown="if(event.key===\'Enter\')chkCl()">â€™;document.getElementById(â€˜qActsâ€™).innerHTML=â€™<button class="btn btn-p" onclick="chkCl()">CevabÄ± Kontrol Et</button>â€™}
document.getElementById(â€˜qContâ€™).innerHTML=h}
function selOpt(i){if(QAd)return;selMC=i;document.querySelectorAll(â€™.qoptâ€™).forEach(function(e,j){e.classList.toggle(â€˜selâ€™,j===i)});document.getElementById(â€˜chkBâ€™).disabled=false}
function chkMC(){if(QAd)return;QAd=true;var q=QZ[QI],ok=q.correctIndex===selMC;document.querySelectorAll(â€™.qoptâ€™).forEach(function(e,i){if(i===q.correctIndex)e.classList.add(â€˜okâ€™);if(i===selMC&&!ok)e.classList.add(â€˜noâ€™);e.style.pointerEvents=â€˜noneâ€™});if(ok)QSC++;if(!ok&&!q.starred)autoStar(q.id);QAs.push({question:q,ua:selMC,ok:ok});nxtBtn()}
function chkCl(){if(QAd)return;QAd=true;var q=QZ[QI],inp=document.getElementById(â€˜qzInpâ€™),ua=inp.value.trim(),ok=ua.toLowerCase()===q.answer.toLowerCase();inp.disabled=true;inp.style.borderColor=ok?â€˜var(â€“success)â€™:â€˜var(â€“danger)â€™;if(!ok)document.getElementById(â€˜qContâ€™).innerHTML+=â€™<div style="text-align:center;padding:10px;color:var(--success);font-size:.9rem">DoÄŸru: <strong>â€™+esc(q.answer)+â€™</strong></div>â€™;if(ok)QSC++;if(!ok&&!q.starred)autoStar(q.id);QAs.push({question:q,ua:ua,ok:ok});nxtBtn()}
function autoStar(id){var q=ALL.find(function(x){return x.id===id});if(q&&!q.starred){q.starred=true;dbPut(q).then(function(){return dbAll()}).then(function(a){ALL=a;stats()})}}
function nxtBtn(){var q=QZ[QI],sb=q.starred?â€™<button class="btn btn-w btn-sm" onclick="toggleStar(\''+q.id+'\');this.remove()">â˜… KaldÄ±r</button>â€™:â€™<button class="btn btn-o btn-sm" onclick="toggleStar(\''+q.id+'\');this.textContent=\'â˜…\';this.className=\'btn btn-w btn-sm\'">â˜† YÄ±ldÄ±zla</button>â€™;
document.getElementById(â€˜qActsâ€™).innerHTML=â€™<div class="btn-group" style="justify-content:center">â€™+sb+(QI<QZ.length-1?â€™<button class="btn btn-p" onclick="QI++;renderQzQ()">Sonraki â†’</button>â€™:â€™<button class="btn btn-s" onclick="showRes()">SonuÃ§lar ğŸ†</button>â€™)+â€™</div>â€™}
function showRes(){document.getElementById(â€˜qPlayâ€™).classList.add(â€˜hiddenâ€™);var r=document.getElementById(â€˜qResâ€™);r.classList.remove(â€˜hiddenâ€™);var tot=QZ.length,wr=tot-QSC,pct=Math.round((QSC/tot)*100),em=pct<50?â€˜ğŸ’ªâ€™:pct<75?â€˜ğŸ‘â€™:pct<100?â€˜ğŸŒŸâ€™:â€˜ğŸ†â€™,L=[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™,â€˜Dâ€™,â€˜Eâ€™];
var h=â€™<div class="card rcard"><div style="font-size:2.8rem;margin-bottom:6px">â€™+em+â€™</div><div class="rsc">%â€™+pct+â€™</div><div style="font-size:.95rem;color:var(--text-dim);margin-top:4px">BaÅŸarÄ± OranÄ±</div><div class="rbd"><div class="ri cok"><div class="rn">â€™+QSC+â€™</div><div class="rl">DoÄŸru</div></div><div class="ri cno"><div class="rn">â€™+wr+â€™</div><div class="rl">YanlÄ±ÅŸ</div></div><div class="ri"><div class="rn" style="color:var(--text)">â€™+tot+â€™</div><div class="rl">Toplam</div></div></div><p style="font-size:.76rem;color:var(--text-dim);margin-bottom:14px">â­ YanlÄ±ÅŸlar otomatik yÄ±ldÄ±zlandÄ±</p><div class="btn-group" style="justify-content:center"><button class="btn btn-p" onclick="startQuiz()">ğŸ”„ Tekrar</button><button class="btn btn-o" onclick="resetQzUI()">âš™ï¸ Ayarlar</button></div></div>â€™;
h+=â€™<div class="card" style="margin-top:12px"><div class="card-title">ğŸ“Š Detaylar</div>â€™;
QAs.forEach(function(a,i){var q=a.question,ic=a.ok?â€˜âœ…â€™:â€˜âŒâ€™,d=â€™â€™;if(q.type===â€˜mcâ€™){d=a.ok?L[a.ua]:L[a.ua]+â€™ â†’ â€˜+L[q.correctIndex]}else{d=a.ok?a.ua:â€™â€â€™+a.ua+â€™â€ â†’ â€œâ€™+q.answer+â€™â€â€™}h+=â€™<div style="padding:10px 0;border-bottom:1px solid var(--border);font-size:.83rem">â€™+ic+â€™ <strong>â€™+(i+1)+â€™.</strong> â€˜+esc(q.question.substring(0,55))+(q.question.length>55?â€™â€¦â€™:â€™â€™)+â€™<div style="color:var(--text-dim);font-size:.75rem;margin-top:2px">â€™+esc(d)+â€™</div></div>â€™});
h+=â€™</div>â€™;r.innerHTML=h}

// â•â•â• IO â•â•â•
function exportData(){if(!ALL.length){toast(â€˜Soru yok!â€™,â€˜errorâ€™);return}var d={app:â€˜BilgiYarismasiâ€™,version:2,exportDate:new Date().toISOString(),count:ALL.length,questions:ALL};var a=document.createElement(â€˜aâ€™);a.href=URL.createObjectURL(new Blob([JSON.stringify(d,null,2)],{type:â€˜application/jsonâ€™}));a.download=â€˜bilgi-â€™+new Date().toISOString().slice(0,10)+â€™.jsonâ€™;a.click();toast(ALL.length+â€™ soru aktarÄ±ldÄ± âœ“â€™)}
function importData(e){var f=e.target.files[0];if(!f)return;f.text().then(function(t){var d=JSON.parse(t);var qs=d.questions||(Array.isArray(d)?d:[]);qs=qs.filter(function(q){return q.type&&q.question});if(!qs.length){toast(â€˜Soru yok!â€™,â€˜errorâ€™);return}window._imp=qs;showM(â€™<h3>ğŸ“¥ Ä°Ã§e Aktar</h3><p style="color:var(--text-dim);font-size:.86rem;margin-bottom:14px">â€™+qs.length+â€™ soru bulundu.</p><div class="btn-group"><button class="btn btn-p btn-sm" onclick="doImp(\'merge\')">BirleÅŸtir</button><button class="btn btn-d btn-sm" onclick="doImp(\'replace\')">DeÄŸiÅŸtir</button><button class="btn btn-o btn-sm" onclick="closeM()">Ä°ptal</button></div>â€™)}).catch(function(){toast(â€˜OkunamadÄ±!â€™,â€˜errorâ€™)});e.target.value=â€™â€™}
function doImp(m){var qs=window._imp;if(!qs)return;var chain=m===â€˜replaceâ€™?dbClr():Promise.resolve();qs.forEach(function(q){if(m===â€˜mergeâ€™)q.id=uid();if(!q.createdAt)q.createdAt=new Date().toISOString();if(q.starred===undefined)q.starred=false;chain=chain.then(function(){return dbPut(q)})});chain.then(function(){return dbAll()}).then(function(a){ALL=a;closeM();stats();cats();renderList();renderStarred();toast(qs.length+â€™ soru aktarÄ±ldÄ± âœ“â€™);window._imp=null})}
function clearAll(){showM(â€™<h3>âš ï¸ TÃ¼mÃ¼nÃ¼ Sil</h3><p style="color:var(--text-dim);font-size:.86rem;margin-bottom:14px">â€™+ALL.length+â€™ soru silinecek!</p><div class="btn-group"><button class="btn btn-d btn-sm" onclick="confirmClr()">Sil</button><button class="btn btn-o btn-sm" onclick="closeM()">Ä°ptal</button></div>â€™)}
function confirmClr(){dbClr().then(function(){ALL=[];closeM();stats();cats();renderList();renderStarred();toast(â€˜Silindiâ€™)})}

// â•â•â• UTILS â•â•â•
function esc(s){var d=document.createElement(â€˜divâ€™);d.textContent=s||â€™â€™;return d.innerHTML}
function fmtD(iso){if(!iso)returnâ€™â€™;return new Date(iso).toLocaleDateString(â€˜tr-TRâ€™,{day:â€˜numericâ€™,month:â€˜shortâ€™,year:â€˜numericâ€™})}
function stats(){document.getElementById(â€˜sTâ€™).textContent=ALL.length;document.getElementById(â€˜sMâ€™).textContent=ALL.filter(function(q){return q.type===â€˜mcâ€™}).length;document.getElementById(â€˜sCâ€™).textContent=ALL.filter(function(q){return q.type===â€˜classicâ€™}).length;document.getElementById(â€˜sAâ€™).textContent=ALL.filter(function(q){return q.type===â€˜audioâ€™}).length;document.getElementById(â€˜sSâ€™).textContent=ALL.filter(function(q){return q.starred}).length;document.getElementById(â€˜stInfoâ€™).textContent=â€˜IndexedDB Â· â€˜+ALL.length+â€™ soru Â· Cihazda gÃ¼venle saklanÄ±yorâ€™}
function cats(){var cs=[];ALL.forEach(function(q){if(q.category&&cs.indexOf(q.category)===-1)cs.push(q.category)});cs.sort();[â€˜fCatâ€™,â€˜qzCatâ€™].forEach(function(id){var el=document.getElementById(id);if(!el)return;var cv=el.value;el.innerHTML=â€™<option value="all">TÃ¼m Kategoriler</option>â€™+cs.map(function(c){returnâ€™<option value="'+esc(c)+'">â€™+esc(c)+â€™</option>â€™}).join(â€™â€™);el.value=cv});document.getElementById(â€˜catDLâ€™).innerHTML=cs.map(function(c){returnâ€™<option value="'+esc(c)+'">â€™}).join(â€™â€™)}
document.getElementById(â€˜srcInpâ€™).addEventListener(â€˜inputâ€™,renderList);document.getElementById(â€˜fTypeâ€™).addEventListener(â€˜changeâ€™,renderList);document.getElementById(â€˜fCatâ€™).addEventListener(â€˜changeâ€™,renderList);

// â•â•â• INIT â•â•â•
openDB().then(function(){return dbAll()}).then(function(a){ALL=a;var chain=Promise.resolve();ALL.forEach(function(q){if(q.starred===undefined){q.starred=false;chain=chain.then(function(){return dbPut(q)})}});return chain.then(function(){return dbAll()})}).then(function(a){ALL=a;stats();cats();renderList()}).catch(function(e){toast(â€˜DB hatasÄ±!â€™,â€˜errorâ€™)});
</script>

</body>
</html>
